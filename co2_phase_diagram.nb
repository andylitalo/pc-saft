(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     56336,       1435]
NotebookOptionsPosition[     53385,       1334]
NotebookOutlinePosition[     53763,       1350]
CellTagsIndexPosition[     53720,       1347]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["CO2 Phase Diagram", "Title",
 CellChangeTimes->{{3.766171115195342*^9, 3.7661711186790104`*^9}}],

Cell["\<\
PC-SAFT (Perturbed-Chain Statistical Associating Fluid Theory)\
\>", "Subtitle",
 CellChangeTimes->{{3.766171121135342*^9, 3.7661711344505033`*^9}}],

Cell["\<\
Andy Ylitalo, with guidance from Dr. Huikuan Chao and mentorship from Prof. \
Zhen-Gang Wang\
\>", "Subsubtitle",
 CellChangeTimes->{{3.76617114052406*^9, 3.7661711558771763`*^9}}],

Cell["Questions", "Section",
 CellChangeTimes->{{3.7667685253386035`*^9, 3.7667685299100657`*^9}}],

Cell[CellGroupData[{

Cell["0. Setup", "Section",
 CellChangeTimes->{{3.7664366427323756`*^9, 3.766436646161707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<C:\>\"", ",", "\"\<Users\>\"", ",", "\"\<Andy.DESKTOP-CFRG05F\>\"", 
      ",", "\"\<OneDrive - California Institute of Technology\>\"", ",", " ", 
      "\"\<Documents\>\"", ",", " ", "\"\<Research\>\"", ",", " ", 
      "\"\<Wang\>\"", ",", " ", "\"\<PC-SAFT\>\""}], "}"}], "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766436649632274*^9, 3.7664367319724555`*^9}, {
   3.766437154420802*^9, 3.7664372330614023`*^9}, {3.766437450288994*^9, 
   3.7664374718696346`*^9}, 3.766437523104933*^9, {3.766437596139181*^9, 
   3.766437635410695*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Equations", "Section",
 CellChangeTimes->{{3.766171165943899*^9, 3.766171173160204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_"}], "]"}], ":=", 
    RowBox[{"\[Sigma]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"0.12", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "\[Epsilon]", " ", "\[Beta]"}], "]"}]}]}], 
      ")"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temperature", "-", 
     RowBox[{"dependent", " ", "particle", " ", "diameter"}]}], ",", " ", 
    RowBox[{"Gross", " ", "and", " ", "Sadowski", " ", 
     RowBox[{"(", "2001", ")"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7668427841617417`*^9, 3.766842831233387*^9}, {
  3.7668434766043406`*^9, 3.7668434768230743`*^9}}],

Cell[CellGroupData[{

Cell["Free energy of ideal gas", "Subsection",
 CellChangeTimes->{{3.766171233515663*^9, 3.7661712341291666`*^9}, {
  3.766173490817514*^9, 3.766173493167342*^9}, {3.766174768164322*^9, 
  3.766174769834175*^9}, {3.7664390361034045`*^9, 3.766439036760029*^9}, {
  3.7666277515983553`*^9, 3.7666277647938395`*^9}, {3.766838373703772*^9, 
  3.76683837386001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fIG", "[", 
    RowBox[{"\[Rho]_", ",", 
     RowBox[{"N_:", "2"}]}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"\[Rho]", "/", "N"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"\[Rho]", " ", "/", "N"}], " ", "]"}], "-", "1"}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766173495360677*^9, 3.7661735646375465`*^9}, {
  3.7661740527076983`*^9, 3.766174096833743*^9}, {3.7661741366484365`*^9, 
  3.7661741395388265`*^9}, {3.766174173677554*^9, 3.7661741742419634`*^9}, {
  3.7661745534022655`*^9, 3.7661745894624033`*^9}, {3.766174738884039*^9, 
  3.766174762853978*^9}, {3.766176158706545*^9, 3.7661761778263755`*^9}, {
  3.766176241130987*^9, 3.766176293551489*^9}, {3.7667682831145697`*^9, 
  3.7667682833825817`*^9}, {3.766768511490551*^9, 3.7667685116596627`*^9}, {
  3.7667687721705666`*^9, 3.7667688034988256`*^9}, {3.767364514296425*^9, 
  3.7673645203627324`*^9}, {3.7673663546122684`*^9, 3.767366371261894*^9}, {
  3.767375002629463*^9, 3.7673750047046337`*^9}, {3.7673752030920825`*^9, 
  3.767375218974571*^9}}],

Cell["\<\
Cubed expression is the thermal de Broglie wavelength, \[Lambda]T = h / \
Sqrt[2 \[Pi] m k T]. m is the mass of a single particle (in this case, CO2 \
atom, kg). Note that \[Rho] is divided by N to get the density of molecules, \
not segments.
7.31*^-26 kg is the mass of a carbon dioxide atom (44.01 amu). \
\>", "Text",
 CellChangeTimes->{{3.7661747732541103`*^9, 3.7661748095980577`*^9}, 
   3.7667617533495283`*^9, {3.7667682880081244`*^9, 3.766768301580989*^9}, {
   3.7667685143311977`*^9, 3.766768516588797*^9}, {3.76735987296021*^9, 
   3.767359906421975*^9}, {3.7673651868060703`*^9, 3.7673652115042253`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of hard-sphere liquid", "Subsection",
 CellChangeTimes->{{3.7661741080583067`*^9, 3.766174157628705*^9}}],

Cell["\<\
Note that \[Xi][\[Rho],\[Sigma],3] represents the total packing fraction and \
is therefore dimensionless. In general, \[Xi][\[Rho],\[Sigma],n] has \
dimensions of (length)^(n-3).\
\>", "Text",
 CellChangeTimes->{{3.766438941825284*^9, 3.766438953235751*^9}, {
  3.7673599418292875`*^9, 3.7673599677462387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Xi]", "[", 
    RowBox[{"\[Rho]_", ",", "d_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "6"}], " ", "\[Rho]", " ", 
    RowBox[{"d", "^", "j"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766174455815523*^9, 3.7661744951115713`*^9}, {
  3.766176313221929*^9, 3.7661763254382534`*^9}, {3.766843191369383*^9, 
  3.766843192623335*^9}, {3.76737490633406*^9, 3.7673749082330704`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fHS", "[", 
    RowBox[{"\[Rho]_", ",", "d_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"6", "/", "\[Pi]"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", " ", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "1"}], "]"}], 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "2"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "2"}], "]"}], ")"}], "^", "3"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}], "^", 
          "2"}]}], ")"}]}], "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "2"}], "]"}], ")"}], "^", "3"}],
           "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
           "2"}]}], "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], "]"}]}]}], " ", 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766174160022661*^9, 3.766174171388861*^9}, {
  3.766174256683544*^9, 3.766174449311809*^9}, {3.766174502081717*^9, 
  3.766174505141653*^9}, {3.7661748429549804`*^9, 3.7661748456350355`*^9}, {
  3.76684284471607*^9, 3.7668429263459635`*^9}, {3.7668431280872355`*^9, 
  3.766843183383767*^9}, {3.7670252913868036`*^9, 3.767025319235235*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of association", "Subsection",
 CellChangeTimes->{{3.766174906096306*^9, 3.7661749100152345`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gii", "[", 
     RowBox[{"\[Rho]_", ",", "d_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}]}], "+", " ", 
     RowBox[{"3", 
      RowBox[{"\[Xi]", "[", 
       RowBox[{"\[Rho]", ",", "d", ",", "2"}], "]"}], " ", 
      RowBox[{"d", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}], "^", 
          "2"}]}], ")"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"\[Rho]", ",", "d", ",", "2"}], "]"}], ")"}], "^", "2"}], 
      RowBox[{
       RowBox[{"d", "^", "2"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}], "^", 
          "3"}]}], ")"}]}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "radial", " ", "pair", " ", "distribution", " ", "function", " ", "for", 
     " ", "segments", " ", "of", " ", "component", " ", "i", " ", "in", " ", 
     "the", " ", "hard"}], "-", 
    RowBox[{"sphere", " ", "system"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.766175024721139*^9, 3.766175121639538*^9}, {
  3.766175194839213*^9, 3.7661751978986387`*^9}, {3.766761596679305*^9, 
  3.766761596859725*^9}, {3.7667616749936595`*^9, 3.766761675674391*^9}, {
  3.7668384835628815`*^9, 3.766838487945043*^9}, {3.766838619640038*^9, 
  3.766838644024268*^9}, {3.7668429301888638`*^9, 3.7668429468367915`*^9}, {
  3.7668430745531936`*^9, 3.7668431076700125`*^9}, {3.7668434342354755`*^9, 
  3.7668434381496983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fAssoc", "[", 
    RowBox[{"\[Rho]_", ",", "d_", ",", 
     RowBox[{"N_:", "2"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"N", "-", "1"}], ")"}]}], "/", "N"}], " ", "\[Rho]", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"gii", "[", 
      RowBox[{"\[Rho]", ",", "d"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7661749496877813`*^9, 3.766175019246869*^9}, {
  3.7661764607830925`*^9, 3.7661764676288548`*^9}, {3.7668429554123163`*^9, 
  3.7668429630468483`*^9}, {3.7668430800440617`*^9, 3.766843086995576*^9}, {
  3.76684326075173*^9, 3.766843268420308*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of dispersion", "Subsection",
 CellChangeTimes->{{3.766175210819456*^9, 3.7661752339640107`*^9}}],

Cell["\<\
First, load the constants for the polynomial approximation of the integrals \
I1 and I2 in Gross and Sadowski (2001). We refer to them here as J1 and J2 \
according to the nomenclature used by Xu et al. (2012).\
\>", "Text",
 CellChangeTimes->{{3.7668384978702345`*^9, 3.7668385859469624`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JConstants", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "\"\<J_integral_const_a_b.csv\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7664369419245267`*^9, 3.766436954757347*^9}, {
  3.7664376534873466`*^9, 3.766437653795168*^9}, {3.766438266219169*^9, 
  3.766438278987294*^9}, {3.7664383576049814`*^9, 3.7664384019099617`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a0", "=", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "3"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b0", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "5"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "6"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "7"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7664384033871202`*^9, 3.7664384693527374`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", " ", 
    RowBox[{"a0", " ", "+", "  ", 
     RowBox[{"a1", "/", "2"}]}]}], " ", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"full", " ", 
     RowBox[{"formula", ":", " ", "a"}]}], " ", "=", " ", 
    RowBox[{"a0", " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], "/", "N"}], " ", "a1"}], " ", "+", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], "/", "N"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "2"}], ")"}], "/", "N"}], " ", "a2"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", " ", 
    RowBox[{"b0", " ", "+", "  ", 
     RowBox[{"b1", "/", "2"}]}]}], " ", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"full", " ", 
     RowBox[{"formula", ":", " ", "b"}]}], " ", "=", " ", 
    RowBox[{"b0", " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], "/", "N"}], " ", "b1"}], " ", "+", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "1"}], ")"}], "/", "N"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N", "-", "2"}], ")"}], "/", "N"}], " ", "b2"}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766438559609538*^9, 3.7664386241090984`*^9}, {
  3.7664387629853544`*^9, 3.7664387890500956`*^9}, {3.76643897929191*^9, 
  3.766439002765489*^9}, {3.7664578863414116`*^9, 3.7664579327468405`*^9}, {
  3.767360061246483*^9, 3.7673600648194036`*^9}, {3.7673601073132367`*^9, 
  3.767360135279725*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J1", "[", 
   RowBox[{"\[Rho]_", ",", "d_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", "i", "]"}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "[", 
   RowBox[{"\[Rho]_", ",", "d_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"[", "i", "]"}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.7661752374026213`*^9, 3.7661752430499077`*^9}, {
  3.766176373765312*^9, 3.7661765329294624`*^9}, {3.7661765909205303`*^9, 
  3.766176601720431*^9}, {3.7661766334367704`*^9, 3.7661766690852737`*^9}, {
  3.766436041192528*^9, 3.7664360657014275`*^9}, {3.766438635617507*^9, 
  3.7664387304939384`*^9}, {3.7664565272634487`*^9, 3.766456528545709*^9}, {
  3.7664569266507397`*^9, 3.766456933414873*^9}, {3.7673749155587687`*^9, 
  3.767374920502219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{"\[Rho]_", ",", "d_", ",", 
      RowBox[{"N_:", "2"}]}], "]"}], ":=", 
    RowBox[{"1", "+", 
     RowBox[{"N", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
           "2"}]}]}], ")"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}], "^", 
        "4"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "N"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20", " ", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], " ", "-", " ", 
         RowBox[{"27", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
           "2"}]}], " ", "+", " ", 
         RowBox[{"12", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
           "3"}]}], " ", "-", " ", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}], ")"}], "^", 
           "4"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}], "^", 
          "2"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"\[Rho]", ",", "d", ",", "3"}], "]"}]}], ")"}], "^", 
          "2"}]}], ")"}]}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"dimensionless", "--"}], "might", " ", "be", " ", "a", " ", 
    "typo", " ", 
    RowBox[{"(", 
     RowBox[{
     "compare", " ", "eqn", " ", "25", " ", "of", " ", "Gross", " ", "and", 
      " ", "Sadowski", " ", "and", " ", "the", " ", "eqn", " ", "for", " ", 
      "M", " ", "below", " ", "eqn", " ", "6", " ", "in", " ", "Xu", " ", 
      "et", " ", "al"}], " "}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.766438737231091*^9, 3.766438737553897*^9}, {
  3.7664387977801*^9, 3.7664388990277867`*^9}, {3.7664389611692085`*^9, 
  3.7664389617378836`*^9}, {3.7664565195138807`*^9, 3.7664565239123616`*^9}, {
  3.766457962604103*^9, 3.7664579642781477`*^9}, {3.7668432020485735`*^9, 
  3.7668432221504908`*^9}, {3.767360280922468*^9, 3.7673603229207735`*^9}, {
  3.767360456474064*^9, 3.767360505896178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fDisp", "[", 
    RowBox[{
    "\[Rho]_", ",", "\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_", ",", 
     RowBox[{"N_:", "2"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], " ", 
    RowBox[{"\[Rho]", "^", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"J1", "[", 
        RowBox[{"\[Rho]", ",", 
         RowBox[{"d", "[", 
          RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], ",",
          "N"}], "]"}], " ", "\[Beta]", " ", "\[Epsilon]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"N", " ", "/", 
        RowBox[{"M", "[", 
         RowBox[{"\[Rho]", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], 
          ",", "N"}], "]"}]}], " ", 
       RowBox[{"J2", "[", 
        RowBox[{"\[Rho]", ",", 
         RowBox[{"d", "[", 
          RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], ",",
          "N"}], "]"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Beta]", " ", "\[Epsilon]"}], ")"}], "^", "2"}]}]}], ")"}],
     " ", 
    RowBox[{"\[Sigma]", "^", "3"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766842721977187*^9, 3.766842734394769*^9}, {
  3.766843036334453*^9, 3.766843040136225*^9}, {3.767374924454935*^9, 
  3.7673749320444775`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total Free Energy", "Subsection",
 CellChangeTimes->{{3.7664391165434985`*^9, 3.7664391199245777`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]f", "[", 
    RowBox[{
    "\[Rho]_", ",", "\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_", ",", 
     RowBox[{"N_:", "2"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]fIG", "[", "\[Rho]", "]"}], "+", 
    RowBox[{"\[Beta]fHS", "[", 
     RowBox[{"\[Rho]", ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}]}], 
     "]"}], "+", 
    RowBox[{"\[Beta]fAssoc", "[", 
     RowBox[{"\[Rho]", ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], ",", 
      "N"}], "]"}], "+", 
    RowBox[{"\[Beta]fDisp", "[", 
     RowBox[{
     "\[Rho]", ",", "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]", ",", "N"}],
      "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766439121586608*^9, 3.7664391818260727`*^9}, {
   3.7667608794334183`*^9, 3.7667608797155128`*^9}, {3.766760944405161*^9, 
   3.7667609445744133`*^9}, {3.766761084729862*^9, 3.76676112874378*^9}, {
   3.7667611775401335`*^9, 3.7667611802824593`*^9}, {3.7667613419661603`*^9, 
   3.7667613421134043`*^9}, {3.766762115229057*^9, 3.766762118740593*^9}, {
   3.766762161555049*^9, 3.7667621874479475`*^9}, {3.76683866472351*^9, 
   3.766838733559309*^9}, {3.766840000442275*^9, 3.7668400052743864`*^9}, {
   3.7668432395832357`*^9, 3.7668432488361473`*^9}, 3.7668432821412945`*^9, {
   3.767375225112522*^9, 3.767375225261249*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chemical potential", "Subsection",
 CellChangeTimes->{{3.7664392169199877`*^9, 3.766439222786623*^9}, {
   3.7664394123047304`*^9, 3.766439424689309*^9}, 3.7664572709226704`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Mu]", "[", 
    RowBox[{
    "\[Rho]_", ",", "\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_", ",", 
     RowBox[{"N_:", "2"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]f", "[", 
       RowBox[{
       "\[Rho]prime", ",", "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]", ",",
         "N"}], "]"}], ",", "\[Rho]prime"}], "]"}], "/.", 
    RowBox[{"\[Rho]prime", "\[Rule]", "\[Rho]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7667606020409293`*^9, 3.7667606640878563`*^9}, {
  3.7667607091182785`*^9, 3.766760714617767*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pressure", "Subsection",
 CellChangeTimes->{{3.7664394281193423`*^9, 3.766439446366357*^9}, {
  3.7664570995752974`*^9, 3.7664571002089205`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]p", "[", 
    RowBox[{
    "\[Rho]_", ",", "\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_"}], "]"}],
    ":=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Beta]f", "[", 
      RowBox[{"\[Rho]", ",", "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], 
      "]"}]}], "+", 
    RowBox[{"\[Rho]", " ", 
     RowBox[{"\[Beta]\[Mu]", "[", 
      RowBox[{"\[Rho]", ",", "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], 
      "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.76645711433683*^9, 3.766457147062825*^9}, {
  3.766457504081125*^9, 3.766457557203376*^9}, {3.7664583213730125`*^9, 
  3.7664583409633703`*^9}, {3.766458746680251*^9, 3.766458767119524*^9}, {
  3.7664588906435037`*^9, 3.766458892519684*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Plot", "Section",
 CellChangeTimes->{{3.766457570078002*^9, 3.766457575486906*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kB", "=", " ", "1.38065*^-23"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Boltzmann", " ", 
    RowBox[{"constant", " ", "[", 
     RowBox[{"J", "/", "K"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "290"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"temperature", " ", "[", "K", "]"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]CO2", "=", "170.5"}], " ", ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"attractive", " ", "well", " ", "depth"}], ",", " ", 
    RowBox[{"from", " ", "Xu", " ", "et", " ", 
     RowBox[{"al", ".", " ", "2012"}], " ", 
     RowBox[{"JCP", " ", "[", "J", "]"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]CO2", "=", " ", "2.79*^-10"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"bead", " ", 
    RowBox[{"size", " ", "[", "m", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]CO2Ref", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "use", " ", "bead", " ", "size", " ", "as", " ", "reference", " ", 
    "length", " ", "for", " ", "system"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dCO2", " ", "=", " ", 
    RowBox[{"\[Sigma]CO2", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"0.12", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "\[Epsilon]CO2", "*", "\[Beta]Param"}], 
         "]"}]}]}], ")"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temperature", "-", 
     RowBox[{"dependent", " ", "particle", " ", "diameter"}]}], ",", " ", 
    RowBox[{"Gross", " ", "and", " ", "Sadowski", " ", 
     RowBox[{"(", "2001", ")"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]min", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"minimum", " ", "mass", " ", "density", " ", "to", " ", 
    RowBox[{"plot", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]max", " ", "=", " ", "1100"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"maximum", " ", "mass", " ", "density", " ", "to", " ", 
    RowBox[{"plot", " ", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCO2", " ", "=", " ", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "number", " ", "of", " ", "beads", " ", "for", " ", "one", " ", "carbon", 
    " ", "dioxide", " ", 
    RowBox[{"molecule", " ", "[", "nondim", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBeadCO2", "=", " ", 
    RowBox[{"0.044", "/", "NCO2"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "molar", " ", "mass", " ", "of", " ", "one", " ", "bead", " ", "of", " ", 
    "carbon", " ", 
    RowBox[{"dioxide", " ", "[", 
     RowBox[{"kg", "/", "mol"}], "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NA", " ", "=", " ", "6.022*^23"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Avogadro", "'"}], "s", " ", 
    RowBox[{"number", " ", "[", 
     RowBox[{"molecules", "/", "mol"}], "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]CO2Conv", "=", 
    RowBox[{
     RowBox[{"\[Sigma]CO2", "^", "3"}], "*", 
     RowBox[{"NA", "/", "MBeadCO2"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convert", " ", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"molecules", "/", "kg"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pa2MPa", " ", "=", " ", "1*^-6"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"multiplicative", " ", "conversion", " ", "from", " ", "Pa"}], 
    " ", "\[Rule]", " ", "MPa"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pCO2Conv", " ", "=", " ", 
   RowBox[{"Pa2MPa", "*", "kB", " ", "*", "T", "*", 
    RowBox[{"\[Sigma]CO2", "^", 
     RowBox[{"(", 
      RowBox[{"-", "3"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7664591936153975`*^9, 3.766459248347232*^9}, 
   3.766624476976756*^9, {3.76662720945208*^9, 3.7666273494900618`*^9}, {
   3.7666273859603004`*^9, 3.7666273974370823`*^9}, {3.766627452208065*^9, 
   3.7666275948992662`*^9}, {3.76662786647266*^9, 3.7666278834680777`*^9}, {
   3.76676073771898*^9, 3.766760780433696*^9}, {3.766761024018258*^9, 
   3.7667610248958206`*^9}, {3.7667612138696575`*^9, 3.76676132635797*^9}, {
   3.766762070305524*^9, 3.7667620929160414`*^9}, {3.7667621312693715`*^9, 
   3.766762151021905*^9}, {3.766768111232124*^9, 3.7667682752769012`*^9}, {
   3.766768323142599*^9, 3.766768323392592*^9}, {3.7667685026193175`*^9, 
   3.7667685038571196`*^9}, {3.7667687821597385`*^9, 
   3.7667687827561903`*^9}, {3.7667688690894623`*^9, 3.766768886711793*^9}, {
   3.766768966321562*^9, 3.7667689763525505`*^9}, {3.7667690504873285`*^9, 
   3.7667690520154223`*^9}, {3.766841236834464*^9, 3.766841298106201*^9}, {
   3.766841414759708*^9, 3.766841415156062*^9}, {3.7668416585292587`*^9, 
   3.7668416670358143`*^9}, {3.7668417299185967`*^9, 
   3.7668417830632424`*^9}, {3.7668418836475887`*^9, 3.766841940273589*^9}, {
   3.766842039604266*^9, 3.766842040470434*^9}, {3.7668425644026303`*^9, 
   3.766842585199622*^9}, {3.7668437565206966`*^9, 3.7668437643884916`*^9}, {
   3.7670130880822973`*^9, 3.767013105478735*^9}, {3.7670251893747478`*^9, 
   3.767025189755666*^9}, {3.767364297945385*^9, 3.7673643229792128`*^9}, {
   3.767366451076212*^9, 3.7673664936360264`*^9}, {3.7673665372417355`*^9, 
   3.7673665387229147`*^9}, {3.7673750435401344`*^9, 
   3.7673750706586685`*^9}, {3.767375368952506*^9, 3.7673754393884172`*^9}, {
   3.7673754985795546`*^9, 3.7673755235951304`*^9}, {3.7673755815413866`*^9, 
   3.7673755876932287`*^9}, {3.7673756378214974`*^9, 
   3.7673757111780515`*^9}, {3.7673757942251964`*^9, 
   3.7673758366324706`*^9}, {3.767376326198023*^9, 3.7673763732391396`*^9}, {
   3.7674071044645166`*^9, 3.767407148463358*^9}, {3.7674558230630198`*^9, 
   3.7674558407096605`*^9}, {3.767456091739439*^9, 3.767456091850152*^9}, {
   3.7680759240918427`*^9, 3.7680759284995403`*^9}, {3.768076036614266*^9, 
   3.768076039166411*^9}, {3.7680763780626774`*^9, 3.7680763803730974`*^9}, {
   3.7680764111582766`*^9, 3.768076433203422*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]p", "[", 
      RowBox[{
       RowBox[{"\[Rho]", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref", ",", 
       RowBox[{"1", "/", "T"}], ",", "\[Epsilon]CO2"}], "]"}], "*", 
     "pCO2Conv"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]", ",", "\[Rho]min", ",", " ", "\[Rho]max"}], "}"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<density (kg/m^3)\>\"", ",", "\"\<pressure (MPa)\>\""}], 
      "}"}]}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7668413436808233`*^9, 3.766841343846241*^9}, {
   3.766841784963161*^9, 3.7668417889315233`*^9}, {3.766842701872473*^9, 
   3.766842704495473*^9}, {3.766843584816844*^9, 3.766843712396203*^9}, {
   3.767366520603008*^9, 3.767366533508975*^9}, {3.7673750747800617`*^9, 
   3.7673750881381173`*^9}, {3.767375401723072*^9, 3.767375402035696*^9}, {
   3.767375561166444*^9, 3.767375606044939*^9}, {3.767375646590478*^9, 
   3.767375652254295*^9}, {3.7673757548665485`*^9, 3.7673757621505704`*^9}, {
   3.76737637093769*^9, 3.767376396715935*^9}, 3.767456084887969*^9, {
   3.7680758355829544`*^9, 3.7680758399188704`*^9}, {3.768076428866644*^9, 
   3.7680764293218904`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV1nk8lF8bBnCSSGPfZsoWCiVrSLYrISJZslSUXbaYsYsSM2OsSUqW7LT8
KFSWFlEoFNJOKVupKLRYKt7n/Ws+3888c+Y551z3fc56j2A77xVsbGwD7Gxs
///sLY9dvzZlzjArJLE2veyG4ZJWIGd3zgujwekduuxfsow4f+jM5OeMG8lw
nvXfOl5qxHoq6UvP+WXE5dSmNThYZ9TVIlAalcOJ+cy2BtvO+0YB21Lu0XJE
seLkX86I8n4jvZ9mPcE5G7Cx8eVe74MjRnJ2FQ5Hc7RwSG9guaV7xmjR7kra
+AkzzMkO+dLt2BHXr7rvQb0NVHZm+Z6V5sZm9m2hckKO+ODclbNhiBcpT/JG
3ZUcccVy61/FX7yYyP1nXwxHTHAcSpAg8aFc48FWyWBH9NO28DzX5YOUl/Vv
sceOOGqoUsbI5oPQQ69oHqYTbMd4ns2Z8WMx7fSJmQVnbHyi6CJtI4Au8tfU
e8MH8Xhh58sHWYKILm4dDpk7CAYp3P92viAUFc/ryPK6YPryaFVVuSAYOqaj
9G0uUHkrZhpbLwg4Fm3ffcoF1Qs8y71vBHHzjP3n5/quiAmOiLaUFkIx3x2z
LzmHsPque1hJhRD0EjrieS664dmD5QijYmGMraso665zw5qPB+/bXRJGxs3E
jrRmN6ytGzA6XCOMDxMg8b90w6D+pUHPFmHQ997OEeZ0x0C1zvt1H4TRI1Fz
VcLTHTvKbu+3kBKBR0PuWxVpD7Aaa8WrzopgjW3U8vdNHtiq1lvxpUAEN744
ytZqe4D/M6VRtlwEXFIiRzStPZB2Zk/oiToRVNEzfujEeSDncWXK1x4R/LZN
5Nkx6IEau0dHM1eJImUycJt9jidWNz+LlKKKwnA4KOZdqSfejy3vDYsUxY8X
R+/4XvXEtP3I1rY4UbjcC0Fsuyfe1a1SsUsRhWpWmHnFD09svGovpVAmiuc6
sc5ze73Qw6u8UP9MFJKJqVH53N640DTKOq4mhv7ItFsbRLxhyZ/rvVZbDMzA
9L/XpL1xTuZuTo2eGKYdTsW3aXtDiduI87GZGO4rnmFNeXljM4W5856LGHx6
8s4btXpj+9CcQW6SGGooVxpHo32g6+2duemNGHgnvYIu0n3g8n7Fj5Z3YvBv
lpYNOOWD48ejy+1GxCDneTZ1ttwHuYXTi75fxXCuKv4Qe58PRFcOVx74J4Zj
Rk4rpTf6IvqCYLy7jDjMvFfaHOj3xeFmfgt2T3GU6dxbKfXOF51p0sMrfcXB
xhPTNPzJFx5cosscAeJouvpd1u+fL6Te0p79pIlDeX7gV6TiERgmK/OWJIhD
MLU2/+zxI9DYWqS/oUQcb2sOferb5Ie0pZ8aEwPi4HlDEonT9sOR/nTalSFx
6LLfhpKxH0jf1ap9R8RxzlY87+R+P7w/8HHds8/isJnttdJg+cFWTIJydF4c
7Zo76s6M+yHwG4d7vQgZV+vl4hyL/SFz0jOy0IKMt0NPL6+o8ofp9LxQmxUZ
a7jiX15t8Eef4YcvY3vJOOL0VpWr1x+17qVOZEcyZOezRxr++WO/w30XMw8y
cnRXmVMOBiDmQcfTlmgy4u9MCL0VDYQL01TRoIIMx/s2da0ygfAK67pQepGM
LY8abS9uDgRn/4jsyitkDDxjZdJ2BOLGR5LH7atkaH1V5FsdFAiq0fj7xQYy
vlD8Vmu3BWImUkDrXicZrdJPL63rDUS8hdahj91knN+ga84+EIiaP3XXVveQ
Yaq+Ounx90AEf3vz1KSfjGLzyys91wVhi1epQfoAGQ6Rn5dP0YJgHLDAdeQL
GcpxtkXhcUE4p3c6yG6SjBWJTYYHWUEYu9orrPuNjJqM5LiNhUHgbN6p+GeG
DJ5KpT93OoNwgMGZb7dARstzv9+fZY6Cw8fp914uCjZpfJnc2Uv46Jn3GTIU
kM6E/Tf75ij+VcZ+/buegm8/lvxKxo6iyaQrxVeOgrqbwp+WFo5iMWRVssZG
CrbrGgw3yQeDj03sStFmCiyR+UI1Jhi09lfVr7QoUClZmz1EDwbbzpYsfh0K
BFZU2KWfIp7nrpYx2UbB8wdNvV/Kg3Fox5R+2XYKXHaNdlb0BuPdD58CXSMK
tBXWvU8XCgFFdlzm0S4KLjq5GY6Lh4Cm36HVbU4BmVVxQV8yBG/fjXF3W1Cw
OKHq8lUhBK3a6763WFLQfMXkjblBCPQmKB8YeylQHUzeVmwcgvslOWuCbSgo
XtObM7crBHWtncv7bClICNzvWGkXAnOTE7vE7SkwUzn6jONICASUmVHhjhQ0
HLqucTAoBORKNj5TJwoUT82frqOF4EZ5eoSgMwU80wk27nEhaJhb1VG8n4Ke
2pwnzVkh6JSISsh1ocBRq/Vh9N0QDLySzvzpTkGNAJun6YMQyNX2Kxd5EL+f
NFwS6AxB0vd6eTNP4v1L72y99DwEkwdTlJO9KNgo0Fjy8msIDjFOdI76UBD/
9bd+6UwI0m+OBlJ9KRjo0HodNBcC4YT9UX8IZ8Rd5+PkoELf68OTlX4U/Ppy
9ZjmWioqjEnFk/4UWHdMiS1LU7HmdW2NawAFl0qU67o2UCEwrKjdTdjF+cqE
uzoVJreHK/IDKajX/Jy4RYeKlcw9Z5YIC/ArSi/oU9HZMPTHNYiCtvYKh0xz
Kthe3jMROkqBVMnY9EFrKvZ3aSn6Eo6KlUtT2EfFU23J9EbCypol95sPU+G9
MWnYJpgCJt8H1xRvKso7Nz/PIfzhs9SCQwAVhhuY1oOEs4sLVKciqNCdyfvg
FELk89hgV2MsFcdKQ/9kEjZ3WutDT6DiY4ZheQfhUo397DYsKlLKkt/OE/7L
e75gXQYVR+xHKhSoxH58fqnz6QwVSjkv2O0J17SJPqvLpaJx6vtMDGGe4n1H
jxdRkehyN7KIsNexM6t3V1AxGtyZ3UK42bG/XPQ/KjbrFe0eIkzWEMRwDRVy
+zvz5gnTeG0Gq+qpODH5lMlPo+DxREZE1B0qqoqMBeQIb2x7Imhyn4qAivJt
moTji0jV/I+ocGqKZwfhgRhL88EnVPDIHA60ILzVMWW08hkVEhcfxuwlnKHe
eZz2hvi+coeKHeEJEvdaw/dUVP+zZ9kSNp4wu7l6nIpaCiNlD+GCBwybF1+o
6Pl+QNuM8O/Ctq/F01RMsh1M1yNsE8ORFPibigJnntNbCF9xMJbd9peK4xlT
xhKEV6qfvMuxggbndlY5F+FDpBbnXi4aiqsON3wn5tv4aelHHi8Nx0/8in1O
WOiBwSkfYRpur3ry+ybhwMLYTRoU4vucIxuzCXdE327/J0UDXWQ3bzBhGYdF
t055GkS/zVaZEX62JirHTY0GNhRKTBL7x/5SePKRFg1P7FS97xJWLb4GdT0a
ROS3v04lnLr102d2Mxpi1+cZyxBuWkow9Lek4SS3q/5HIj+fHkmd6behIVs+
3Psy4Z2ujvplB2lQ64ndrUCYqjCbucadhue0V9wjRD6LZtLHQ31okD/m+ieX
8B9Ge4YJlQZZq+aT7ISvX906PM6kIfptgtY1oh6Go/q0rNNomH3+pd6eMP/O
wJT60zSo/Fwb8Yuop4BXZZpJBcR40/l1aoTl2ISZinXE/KWTTZlEfdp2XR3I
bKCh43HBSxHCJ7J3qy7coSHvH9u14iMUDComvO58SMOAfPT2GqK+z9jObAp4
R8Oj17vfXfWmoHVd+olnIzRsluHqUiD8fVzxud4EDSGHWVyFRP+wjHGLI/2g
4YVGRnQC0V84ynp7q7lDMb+bcWAz0Y9Cf1aHTWuG4uJbcbGlgxSUNFt0OuuG
wlbkSr4V4V7WuGSrYSi0Y2ro5w9QsFlS8uFpi1CU+9xmKBL9btQ0jaJ5OBRC
E/JeSkS/tM/xbw5PCYXVNs3sa0T/9Sex7bXLDEXHjIfbfWsi7yfPvlc5F4pw
5w61/j0UXA1oYZsoCUW/w9zoBNG/eSC280BTKKpicu7MEv3//kTrQ8OJULTc
toiJJs6HN65Ozuu+haLJQlfH1ZCC6f7JibkfoUjnCOY3NCD6z11xntrlUBxU
9xafI86XmNNBVnLiYbBop1WbaVOgvp3ylMssDLPnLqu5KhP949pV9zHLMKQ2
DVkJE+fZIXmT2RbbMFgNCOd3KFGQxhcsHOMahi6R9c/kFYh6G2lzmAwLQ0rD
pjf3iPOyODVkoK8sDC3nBSKpYsT+v3s4mssejhuP5G4//kdG1YlvHAe5wuGQ
40jT/EuGuayovARvOGIfhRTnLJKR4OvhVUgOR2deuo/zHBk/Z/6OlaqGY2X6
7ebb02S8WaXx8T/XcDRcbmzhGSWjTK1g4m5TONwFVvA9aydDhx4yNUyNwMXg
3Xr76GRcEv3ZYRQZgfBVutXmCWSQL0YWX4iNQKRmqLpePBmLncft9ydFYERm
MGxtLBl3+NOb+goi4N/6meN+KBnG+ZcZ9x5GgJKlt7GeuD9Z1Y1IXpCMBFQt
T+sakeHxYZ+1c2ckJLZGRY/PiuOORL/npt5IrPCl71WbFofo/r3Rf59HIu17
r3L0lDgePbUoL/4QidJBkxWcE+JQfWC4ODEXiVV8DH3Od+L4W6FYGb0xCk9V
XHgvdxD3xYC///ISo7Bqx1FK0nlxdP4uq35nEA1u9bonY9ri0Lyv4nU6NwbR
rcn9QcFieLNLnrJPKBav3XzoOxNE8VXFu247PQ4xjfWp55NFwNY9XLr33XF8
KdCuajkvjMuZY4+alOLB0Nr4el+mEOzFfn/1eB2Pff92rP1dIIjrVlvYCxNP
oi/UyPdaowDUP+SedTNIwLqwMrL6f/yYWJ33VxQJODXACvpXzo9izTzPbuME
XKO17n5SyA+BpDx1bfMEpD7+XRuZxY/pLflP1tgn4HX4uea5aH7UHCvgbDiS
AP3GMY3LFvxQEy8K581OwMZd5C2/vvJhAkVv759LgOx2Yyf9j3wo9i/aGZWb
AE/W0eqkD3wQaC4SHC1MALNg5Y9NL/gw7VVc3Xg5AUW7zaPKm/lQU1cy7nkv
AcMCc5JHsvigZl3ucOtLAtom/6x2NuCDy56SgctTCRCr52ho0eFDslXh4dzp
BIyqa1FUNfgwsvu8X9TvBPiJc6+VVOBD9q60OO0Vifjvyso3hoJ8mEdYRR0l
EV1Dfg1FH3lxT9Pk1xXzRITe5tBZc44Xkxo7YvIsE3HtE2lk22le4nw0XE62
TkQ+Y5dGUBovQtS2rfbbl4iTzJPDnxN4IbtFWVLBLRGVzw47bg3hBXOjiGlZ
JPG8xatEESteWFPGsvMrE5HSNaq9fTUvDK5ddo+7nAjry+kWhzh5oWwarHK4
KhGnEj7eSWbnxRrq4kPZukTsSAoY/71AwqNHAn8u303EC7q65OavJOyMMnBv
fJ6IC70OGit6SdDg41DJe5WIzqX7QsXdJMiWP1o8NpCIuS6hF6aPSGDrs882
+pAISSVLmcutJDQr+D/s+JoIJ6d7jb03SNj26tyWFyvocHrmZVheQIJCkMti
PScdwZfE5dpySRDjkH14npuOtLP5wZPnSPilUu3mwkfHn6N6Ho6nSahjPjgz
SqGjUPbbhUwmCSUSyW7tEnQIXVtb+zORhMw66y0Xpel4bzwc4n6ShOChNx3+
G+gYzl8iO8SSoKw9vTCjRgeV8/1yBY2EdY9vdjzTJJ5Xkgq0CSGBx+PYmZva
dNgs/O3iOErC5/RVW6L16YiN+5PI8COhclzCjc2cDuHjDwZ/uZGw/qxFB99h
OnzaXBdO25IQU3r3e7M7HVfaC+9O7SXh+TV1SrAXHX2bDB7aWpPA7KIE9vrR
8ZSy95GGJQmTy58FM8PoGEGP3X5TEkx5D+khko66e+NC8ztJKFzb7zUdTYfe
0PZ9RcYk2GrdarA5QUfF1jdRXCCh3j/FVTCFjuOnPKWM9EgQiFpitqbRUVTV
eUd2Owl+DFoN9RTxPnGWFH5dEiSKD3D0Z9NR7em6eYUOCeHVPcoJOXTwrHOY
5tYmoeeWsaNGHh1V/TpZZC0STr7YdDmriI5j/5pS7TRJGBgp7DcupaOSNjwb
q0HC1mmhv7PldOR/43CsUSfhI88fa/srdDxpjlDVUCMB5OAojmo6Wi8H34xX
JSF3w2jJ9Wt0LHTfcHytQoIVun8K36SjfqaEp2wLCRV7jKTaGuhocRLeIkZ4
6cD1XWG36Ji/45mSpUyC8xEFqvxdOiTWJ2wiE64Nz897fo94vwp30Yubif1L
5G+j3yfyk7FgZ0TYKzNxams7HedMTb9+2ETC3QtzYuMP6bjhavIxlbDYfwE4
20WH0qlFSxAOaXzvZ/qE2O97wfJLSiR0ttuf+dVLRy97TWQ7YdlnD+9U9NPx
Jbt7zznCsR/0Pjq8oIP16eXVEMIvpq7xr3pNx/n8L6X7CKv8kdOtH6AjgCmn
YUyYxX3ew+cdHYk1pV66hIdFSWliH+goPpBuvJ3wdrn4mx0jdHz/R3puQjhb
7edQxDgd7NZ71+8nPGVwhFthgsjPNqZGJGEzy7fqr77QkT31ib+IcLGzzcGk
KTpKXl5t7SO84N1G15mm410ZxYZEzM8udNvVT7N0/DMJeGBLuCq+6lXOL2L+
01/kSghzZsiwm8/TcU9mLHqR8KH87E3zi3SE51c+cSXWs/ES975L/+gwDWIq
dBMWrI+Nc2Zj4M/s4CljYj/8H0xXcnMw0NLHwd9GuK3Pq6+Rk4GkpUPVe4n9
jPhqJUdZw0DMLXM/BrH/Jj13/Tn4GOisEgg2JPIhVKtSNyXAwFaVSjoHkZ/q
CIEd98UYOJAezFNH5Ctm/0lWFYUB7d17MvOJ/Jnrz/aek2DgrLuV7Wkin2Ps
zw8FyDJg/cqkpoTIb92YSaXDBgak48hed4h8xz+8OWWkyMAY3/3jo0T+JdJz
YkVUGLgWlCHiRNSLPflg3l1dBj7Vbpx7bkSCzJ/u4Yv6DCTW54rt20HCt3f6
SllGDAx2h/x6T9RjSplUo48pAx82cklJmZFwX2XkBb8tA5Jr7B209hD9SNBe
ctGegZuc26+sI/rBoZ8PvMYcGViyKyTzE/1ioaniR6MLMb8l92BJBxLUTP0E
PY4wgKIukzeuRP4VBpytAhj4leFdoUT0m8c8lsXaRxnYF69wLMmDBN8+ZdU1
YQxw7wy6EeBL9IuD01Y3ThDrV3a87BWVhEBD9+zCBAb6Cspms8OIfK3vH2Qx
GGjnURVxiyTy+vG6v2sqA4Hns/5Jx5FAokWyVuUwMDxSeWNXMlHv+yZ6p3MZ
mJ+dHA5LI+GSzn7xwQIG9vCGoeYUcT782155rZQB34ktrbZEv45hLT1wvsqA
Kosiu6Oc6J+FjOUr7Qx4BpT/G7xPrOdCeZnnIwair54d/q+DqGf7tl0S3Qw8
OOn9mNVFnD9cHJnpfQywPL4N+fUT/xcSLxMyyAAp94NQ1wgJPsbHdmjNMGCR
/6l4zSpeFBbkjU/9YICi5Fdfw8OLl7+bkit/M6DXaBPhyc8Ls//mn4r/JdZT
fUJqlsyLDSIRHourmChXj9K5qcyLsfGQxHsSTGRVmjQNOvJCApkKUdJMrKSc
Pezmwot9ede61WSZ+KO2cv8Pd148sP4mXKrARKnahhCTIF6UNgSU0zWYqGWb
csmm88I92afdwpyJO0aL1T9v8mJI2YXreSgTwn1DW1fK8+G1pMmP4xFMPLnR
w75zMx+e8Sm/V4pmwv3cgY+ZxH3i0fSf+hPHmRhuwPoDO/hw/Ua+z+ZkJgbe
GqWVHeYDS3+wPaGQCav2noZ1RXzQtDpAV+9kojXWLO6bEj9UDIxD3nYzcclk
C3WDJj8UVTa5JPUwcetd2FCgPj+kBBY13z1jQvZqq92Wvfzgfp47yhpiYuee
uyPh4fwYOvjG+MMPJr7Z2t1UbecHK8CZ/ZRUEv4qPv7VvU0Ac+oGa8LWJyHs
31Pqb0MB+MyvF90vn4QsL53jm00FYML4qii3KQkzvzh9b9oKgL3ouE2DVhIO
BfbaWgQIIKa/vOi9VRKW8vvco4oFEKg7Y6B2jBiv2n9ik7AgBpdf7BI9noRd
0Sdq69cKYnfHLdvF+CR8jSpabS0rCEV7uncbMwkGjJGkInVBjAeKpztnJeH9
pYSyHhtBHCo2eBt/OQk//dgveJ0WhA1XSszTV0ngKZgturJOCEqmksP0gSTE
twi9k5AXworEml3b3iXhi4GfaJ6yEG4svRQpGkmCZNu67JsGQqD8lrsWOJWE
gaK/mVQ3IYyM3R3l4mDh5pnQHo5LQgi/P2NlqMJC0QsT9TYjYVizMa7PqLEg
dkWhv8xCGIqG5LUVmizUF7CcTtkLY6DJ8NMaXRYMr3dtSfEVhmFt6sk3O1mY
f6U5yJ8pDO7iDfVh+1kgnW4ZdB8VRl7cfun/6CwEFudqO54RwUTm57LzSSzI
d0nFNBSJQKs8WpGZwsKjPNEBhSoR9HXlqrtnsrBMbxfXbhcBF3lgp3gBC0ev
b6tcPS+CsLoDRxKvs/DD9dTyWTdRWH86WHtwhAWnVYryaQZiKFj8qmUxzkLC
410fxyzF8Jk39pb2BDG+OlPQ+oAY6FsLHgh+Y8HO0rDHNlIMt0++ffFwgYWv
jb28MnViUJRwXdQUTMaYWIb08CZxrLA9RNxikmHy+YKvsRIZtwYL5B8ZJ2Ne
8GFMxTYyqD6DnHTTZOJe+pKfbE7Gh2POj/7sToafedHYZl8y7lXa7fnqkAxJ
Kl2fv5KM2L9mTl0BycgqH+l9vJGCuYuqAaycZDgo3LrkvXUtJpfYzqz8ngxF
9Tss5QQJ+Mhw36mbScbrjAXB/WclMLyDf9ztZzIYHHVvzl2SwEu6pM7dhWT4
e5pYmvVKoIVn+2D4yhTo5uV3hEtKIlssVO4TJQXDngcvSd+VhL7K+PVOkxR0
H3urO7ZaGqmunc8z8lKgONLjcX1KBjH7nqyLvJACvRuB6vmLMjhi+dTjcHEK
xHoEyzO41sNM9820amUKqiIaMs+vX48Vop9JT2uJ8QcWzHQd1yPmMbepcGcK
sgQ2b7nRuh7+euY3c+ZScD5846WWEllYUB6eLd6XitdX7lm3JcmjNCla18kp
FdEzjIRb5+Sx+GvzO94DqXCWf+13p0KeuMdlyh87nIo+zqaA0QfyEEg7cN3B
PxWstZKfm9k24PXSVB9PfCrmF67o1MZuwJExEVL4f6m4MCvAcy1uI1jXPBIs
VqSBzZYjK6JCEY4/BE22c6bBu+ZeJH+TIuR0Wjk3c6fBOXd5ueGxIpqbpZNJ
fGl4xh64dttPRfx88vZULyUNgY7eR37tVMLhSccLDupp6I3OWw74qARtJctG
d7c0XL0tkcTU2YzxUs1v0c1pUJV+N+RLUkFE3H9zLq1pqHFl29wip4JVznLs
aEuD8K60m0p6KtjIKyyyqisNFwtbLqv5q+BI5Kxu1os0GC2n8PB3quCLZS3j
ymQarqtanxdNUcW3nyqSg2vT4Tl/53dbmhrmzTZZ6Uemw1//RCbvNg2ktTe/
OCuXgb6GFZJN97RgVMIaihjKgEdaXcUwtkNoe87ikXWncHJdWV7zvB7+B4mO
9Y0=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"density (kg/m^3)\"", TraditionalForm], 
    FormBox["\"pressure (MPa)\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  PlotRange->{{0, 1100}, {0., 27.97165838701358}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.7667616636590643`*^9, 3.7667616792007785`*^9}, {
   3.766762075244031*^9, 3.7667620861521673`*^9}, {3.76676212714094*^9, 
   3.7667621775412474`*^9}, {3.7667681170950747`*^9, 
   3.7667682512839003`*^9}, {3.7667683132139072`*^9, 
   3.7667683261403975`*^9}, {3.7667687771570597`*^9, 
   3.7667688080922785`*^9}, {3.7667688728345375`*^9, 
   3.7667688807376375`*^9}, {3.7667689571111403`*^9, 3.7667689799741173`*^9}, 
   3.766769014110639*^9, {3.7668386919551425`*^9, 3.7668387417545805`*^9}, 
   3.7668400179191637`*^9, 3.766840076129553*^9, 3.766841315216074*^9, 
   3.7668413524994774`*^9, 3.766841431586795*^9, {3.7668416608342094`*^9, 
   3.766841668776707*^9}, {3.766841732260189*^9, 3.7668417477522936`*^9}, {
   3.76684186355667*^9, 3.7668419414468765`*^9}, {3.7668425755246496`*^9, 
   3.7668425896674395`*^9}, 3.7668433034518585`*^9, 3.76684344463875*^9, {
   3.7668436673382983`*^9, 3.766843727685283*^9}, 3.7668437587156634`*^9, {
   3.7670130949901094`*^9, 3.7670131091771045`*^9}, 3.767025194264166*^9, 
   3.767025324355248*^9, {3.7673604623041487`*^9, 3.767360488803832*^9}, 
   3.7673642881823077`*^9, 3.767364327368361*^9, 3.7673645569761944`*^9, 
   3.767366254487407*^9, 3.7673663624473104`*^9, {3.7673664352423716`*^9, 
   3.7673665274214554`*^9}, 3.7673749431341352`*^9, 3.7673750139428215`*^9, 
   3.7673750926644278`*^9, 3.7673752339795694`*^9, 3.7673753764232316`*^9, 
   3.7673756135548987`*^9, {3.7673756560742693`*^9, 3.767375714299226*^9}, 
   3.7673757653981905`*^9, {3.7673758267298098`*^9, 3.767375841772524*^9}, 
   3.7673763810237803`*^9, {3.7674071097462254`*^9, 3.76740713348602*^9}, 
   3.76745583123678*^9, {3.7674558759186764`*^9, 3.7674559030176497`*^9}, 
   3.767557467261739*^9, {3.767558536344767*^9, 3.767558561732552*^9}, {
   3.767558765399741*^9, 3.767558786592641*^9}, 3.7675594093935957`*^9, 
   3.768074440978024*^9, 3.7680759319253926`*^9, 3.7680761903558006`*^9, 
   3.7680763832448993`*^9, 3.7680764168975906`*^9, 3.7681529406140785`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Numerical Solving", "Section",
 CellChangeTimes->{{3.766171239583239*^9, 3.7661712519377613`*^9}}],

Cell[CellGroupData[{

Cell["Critical Point", "Subsection",
 CellChangeTimes->{{3.766839754582593*^9, 3.7668397558509445`*^9}}],

Cell["\<\
Occurs where both first and second derivatives of pressure with respect to \
density are 0.\
\>", "Text",
 CellChangeTimes->{{3.766839760020883*^9, 3.7668397618747854`*^9}, {
  3.7668398409774218`*^9, 3.7668398505418897`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]CActual", " ", "=", " ", "413.45063"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"kg", "/", 
    RowBox[{"m", "^", "3"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TCActual", " ", "=", " ", "304.25"}], ";"}], " ", 
  RowBox[{"(*", " ", "K", " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.767558493578682*^9, 3.767558518206401*^9}, {
  3.7675587801323385`*^9, 3.7675587807379875`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"criticalPoint", " ", "=", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Beta]p", "[", 
            RowBox[{
             RowBox[{"\[Rho]C", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref",
              ",", 
             RowBox[{"1", "/", "TC"}], ",", "\[Epsilon]CO2"}], "]"}], ",", 
           "\[Rho]C"}], "]"}], ",", "\[Rho]C"}], "]"}], "\[Equal]", "0"}], 
      ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Beta]p", "[", 
              RowBox[{
               RowBox[{"\[Rho]C", "*", "\[Rho]CO2Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", 
               RowBox[{"1", "/", "TC"}], ",", "\[Epsilon]CO2"}], "]"}], ",", 
             "\[Rho]C"}], "]"}], ",", "\[Rho]C"}], "]"}], ",", "\[Rho]C"}], 
        "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Rho]C", ",", "\[Rho]CActual"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"TC", ",", "TCActual"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.767558340771059*^9, 3.7675583491392736`*^9}, {
  3.767558470040307*^9, 3.767558508971439*^9}, {3.767558623292083*^9, 
  3.767558701951111*^9}, {3.767559351055114*^9, 3.7675593582669926`*^9}, {
  3.768152996193303*^9, 3.7681530224937973`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(MachinePrecision\\)\[NoBreak] digits of working precision to \
meet these tolerances. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.7675585627260203`*^9, {3.7675586379127274`*^9, 3.767558650410595*^9}, {
   3.767558738012494*^9, 3.7675587876050596`*^9}, 3.7675594100812044`*^9, 
   3.7680744417498302`*^9, 3.7681529415245466`*^9, {3.768153016799585*^9, 
   3.768153024568593*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Rho]C", "\[Rule]", "420.3544395163189`"}], ",", 
   RowBox[{"TC", "\[Rule]", "301.9628692983125`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7681530246154613`*^9}]
}, Open  ]],

Cell["\<\
The critical point is within 2% of the actual value. Below, the critical \
pressure is calculated in MPa. The actual value is 7.39 MPa (this time, \
within 4%)\
\>", "Text",
 CellChangeTimes->{{3.767558714329653*^9, 3.7675587325496187`*^9}, {
  3.767559417776188*^9, 3.7675594690284157`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pC", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]p", "[", 
     RowBox[{
      RowBox[{"\[Rho]C", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref", ",", 
      RowBox[{"1", "/", "TC"}], ",", "\[Epsilon]CO2"}], "]"}], "*", 
    "pCO2Conv"}], "/.", "criticalPoint"}]}]], "Input",
 CellChangeTimes->{{3.7675593869126062`*^9, 3.7675594267271175`*^9}, {
  3.7681530314959545`*^9, 3.768153037912656*^9}}],

Cell[BoxData["7.158486362027856`"], "Output",
 CellChangeTimes->{{3.768153031953385*^9, 3.7681530384236636`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Fit Parameters from Data", "Section",
 CellChangeTimes->{{3.7661712564080143`*^9, 3.766171272863637*^9}, {
  3.7675595212641764`*^9, 3.767559526414243*^9}}],

Cell[TextData[{
 "Rather than using the parameters given to me by Xiaofei\[CloseCurlyQuote]s \
paper (Xu et al., 2012), I want to estimate the parameters (N, \[Sigma], \
\[Epsilon]) for CO2 using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s FindFit function. We\[CloseCurlyQuote]ll start by \
assuming N = 2."
}], "Text",
 CellChangeTimes->{{3.7675595319620776`*^9, 3.7675595729234223`*^9}, {
  3.7675596461242547`*^9, 3.7675596499430733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"co2EOSData", " ", "=", " ", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Import", " ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Data\>\"", ",", "\"\<co2_eos_data.csv\>\""}], "}"}], 
        "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumberQ"}], ",", "___"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"in", " ", "the", " ", "format", " ", 
     RowBox[{"\[Rho]", " ", "[", 
      RowBox[{"kg", "/", 
       RowBox[{"m", "^", "3"}]}], "]"}]}], ",", " ", 
    RowBox[{"T", " ", "[", "K", "]"}], ",", " ", 
    RowBox[{
     RowBox[{"p", " ", "[", "MPa", "]"}], ";", " ", 
     RowBox[{
     "\"\<Cases\>\"", " ", "command", " ", "with", " ", "options", " ", 
      "\"\<_?NumberQ,___\>\"", " ", "skips", " ", "rows", " ", "that", " ", 
      RowBox[{"don", "'"}], "t", " ", "start", " ", "with", " ", "a", " ", 
      "number"}]}]}], "   ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.768072642124279*^9, 3.7680726637462873`*^9}, {
  3.768072774403158*^9, 3.768072788076539*^9}, {3.7680728848823977`*^9, 
  3.7680729012699556`*^9}, {3.7680744110184097`*^9, 3.7680744335895634`*^9}, {
  3.7680748003500795`*^9, 3.768074814799493*^9}, {3.7680765206817417`*^9, 
  3.768076527913895*^9}, {3.7680766299858465`*^9, 3.7680766331945033`*^9}, {
  3.7681535115057383`*^9, 3.768153525097786*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "T", "]"}]], "Input",
 CellChangeTimes->{{3.7680757591807904`*^9, 3.768075760240693*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FindFit", "[", 
   RowBox[{"co2EOSData", ",", 
    RowBox[{
     RowBox[{"\[Beta]p", "[", 
      RowBox[{
       RowBox[{"\[Rho]", "*", 
        RowBox[{"\[Sigma]", "^", "3"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"NA", "*", "1*^-30"}], ")"}], "/", "MBeadCO2"}]}], ",", "1",
        ",", 
       RowBox[{"1", "/", "T"}], ",", "\[Epsilon]"}], "]"}], "*", "Pa2MPa", 
     "*", "kB", " ", "*", "1*^30", "*", "T", "*", 
     RowBox[{"\[Sigma]", "^", 
      RowBox[{"(", 
       RowBox[{"-", "3"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "2.79"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "170"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]", ",", "T"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Sigma]", " ", "in", " ", "Angstroms"}], ",", " ", 
    RowBox[{"\[Epsilon]", " ", "in", " ", "kB"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.767559575050202*^9, 3.767559660127984*^9}, {
  3.768072806113613*^9, 3.7680728103978744`*^9}, {3.768072892303768*^9, 
  3.768072896963995*^9}, {3.768075906245679*^9, 3.768075909280749*^9}, {
  3.7680760495364656`*^9, 3.768076080836074*^9}, {3.7680761144175344`*^9, 
  3.7680761326994696`*^9}, {3.7680761720118046`*^9, 3.7680763210695243`*^9}, {
  3.768076454311904*^9, 3.7680764658935456`*^9}, {3.7680767786556187`*^9, 
  3.768076783858013*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Sigma]", "\[Rule]", "2.7968228231709293`"}], ",", 
   RowBox[{"\[Epsilon]", "\[Rule]", "171.40609389410477`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7680763217613506`*^9, 3.768076636170737*^9, 
  3.7680767848927975`*^9, 3.768152944751696*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 583},
WindowMargins->{{-5, Automatic}, {Automatic, 5}},
Magnification->0.8999999761581421,
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 102, 1, 72, "Title"],
Cell[684, 25, 158, 3, 44, "Subtitle"],
Cell[845, 30, 190, 4, 24, "Subsubtitle"],
Cell[1038, 36, 98, 1, 63, "Section"],
Cell[CellGroupData[{
Cell[1161, 41, 95, 1, 36, "Section"],
Cell[1259, 44, 684, 14, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1980, 63, 97, 1, 63, "Section"],
Cell[2080, 66, 774, 21, 27, "Input"],
Cell[CellGroupData[{
Cell[2879, 91, 361, 5, 33, "Subsection"],
Cell[3243, 98, 1119, 23, 27, "Input"],
Cell[4365, 123, 628, 10, 43, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5030, 138, 123, 1, 33, "Subsection"],
Cell[5156, 141, 322, 6, 26, "Text"],
Cell[5481, 149, 452, 10, 27, "Input"],
Cell[5936, 161, 2273, 62, 64, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8246, 228, 116, 1, 33, "Subsection"],
Cell[8365, 231, 1982, 52, 46, "Input"],
Cell[10350, 285, 681, 17, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11068, 307, 115, 1, 33, "Subsection"],
Cell[11186, 310, 304, 5, 26, "Text"],
Cell[11493, 317, 471, 10, 27, "Input"],
Cell[11967, 329, 1420, 48, 118, "Input"],
Cell[13390, 379, 1686, 51, 46, "Input"],
Cell[15079, 432, 1566, 42, 46, "Input"],
Cell[16648, 476, 3033, 83, 64, "Input"],
Cell[19684, 561, 1380, 37, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21101, 603, 109, 1, 33, "Subsection"],
Cell[21213, 606, 1442, 31, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22692, 642, 184, 2, 33, "Subsection"],
Cell[22879, 646, 626, 16, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23542, 667, 151, 2, 33, "Subsection"],
Cell[23696, 671, 774, 19, 27, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24519, 696, 92, 1, 63, "Section"],
Cell[24614, 699, 6611, 159, 262, "Input"],
Cell[CellGroupData[{
Cell[31250, 862, 1253, 25, 27, "Input"],
Cell[32506, 889, 12126, 201, 183, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44681, 1096, 107, 1, 63, "Section"],
Cell[CellGroupData[{
Cell[44813, 1101, 104, 1, 33, "Subsection"],
Cell[44920, 1104, 236, 5, 26, "Text"],
Cell[45159, 1111, 476, 12, 46, "Input"],
Cell[CellGroupData[{
Cell[45660, 1127, 1550, 41, 46, "Input"],
Cell[47213, 1170, 919, 17, 35, "Message"],
Cell[48135, 1189, 218, 5, 27, "Output"]
}, Open  ]],
Cell[48368, 1197, 302, 6, 26, "Text"],
Cell[CellGroupData[{
Cell[48695, 1207, 429, 10, 27, "Input"],
Cell[49127, 1219, 113, 1, 27, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49301, 1227, 165, 2, 63, "Section"],
Cell[49469, 1231, 473, 10, 26, "Text"],
Cell[49945, 1243, 1456, 33, 46, "Input"],
Cell[51404, 1278, 126, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[51555, 1284, 1484, 36, 46, "Input"],
Cell[53042, 1322, 303, 7, 27, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
