(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     57544,       1516]
NotebookOptionsPosition[     54839,       1425]
NotebookOutlinePosition[     55183,       1440]
CellTagsIndexPosition[     55140,       1437]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["CO2 Phase Diagram", "Title",
 CellChangeTimes->{{3.766171115195342*^9, 3.7661711186790104`*^9}}],

Cell["\<\
PC-SAFT (Perturbed-Chain Statistical Associating Fluid Theory)\
\>", "Subtitle",
 CellChangeTimes->{{3.766171121135342*^9, 3.7661711344505033`*^9}}],

Cell["\<\
Andy Ylitalo, with guidance from Dr. Huikuan Chao and mentorship from Prof. \
Zhen-Gang Wang\
\>", "Subsubtitle",
 CellChangeTimes->{{3.76617114052406*^9, 3.7661711558771763`*^9}}],

Cell["Questions", "Section",
 CellChangeTimes->{{3.7667685253386035`*^9, 3.7667685299100657`*^9}}],

Cell[CellGroupData[{

Cell["0. Setup", "Section",
 CellChangeTimes->{{3.7664366427323756`*^9, 3.766436646161707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<C:\>\"", ",", "\"\<Users\>\"", ",", "\"\<Andy.DESKTOP-CFRG05F\>\"", 
      ",", "\"\<OneDrive - California Institute of Technology\>\"", ",", " ", 
      "\"\<Documents\>\"", ",", " ", "\"\<Research\>\"", ",", " ", 
      "\"\<Wang\>\"", ",", " ", "\"\<PC-SAFT\>\""}], "}"}], "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766436649632274*^9, 3.7664367319724555`*^9}, {
   3.766437154420802*^9, 3.7664372330614023`*^9}, {3.766437450288994*^9, 
   3.7664374718696346`*^9}, 3.766437523104933*^9, {3.766437596139181*^9, 
   3.766437635410695*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Equations", "Section",
 CellChangeTimes->{{3.766171165943899*^9, 3.766171173160204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_"}], "]"}], ":=", 
    RowBox[{"\[Sigma]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"0.12", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "\[Epsilon]", " ", "\[Beta]"}], "]"}]}]}], 
      ")"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temperature", "-", 
     RowBox[{"dependent", " ", "particle", " ", "diameter"}]}], ",", " ", 
    RowBox[{"Gross", " ", "and", " ", "Sadowski", " ", 
     RowBox[{"(", "2001", ")"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7668427841617417`*^9, 3.766842831233387*^9}, {
  3.7668434766043406`*^9, 3.7668434768230743`*^9}}],

Cell["\<\
Note that \[Xi][\[Rho],\[Sigma],3] represents the total packing fraction and \
is therefore dimensionless. In general, \[Xi][\[Rho],\[Sigma],n] has \
dimensions of (length)^(n-3).\
\>", "Text",
 CellChangeTimes->{3.767456168681527*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Xi]", "[", 
     RowBox[{
     "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "j_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "6"}], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"\[Rho]CO2", " ", 
        RowBox[{"dCO2", "^", "j"}]}], " ", "+", " ", 
       RowBox[{"\[Rho]C5", " ", 
        RowBox[{"dC5", "^", "j"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7674561303420353`*^9, 3.7674561306448402`*^9}, {
  3.767456801082348*^9, 3.7674568222303095`*^9}, {3.767646861217755*^9, 
  3.767646864749775*^9}}],

Cell[CellGroupData[{

Cell["Free energy of ideal gas", "Subsection",
 CellChangeTimes->{{3.766171233515663*^9, 3.7661712341291666`*^9}, {
  3.766173490817514*^9, 3.766173493167342*^9}, {3.766174768164322*^9, 
  3.766174769834175*^9}, {3.7664390361034045`*^9, 3.766439036760029*^9}, {
  3.7666277515983553`*^9, 3.7666277647938395`*^9}, {3.766838373703772*^9, 
  3.76683837386001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fIG", "[", 
    RowBox[{"\[Rho]_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"\[Rho]", "/", "N"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"\[Rho]", " ", "/", "N"}], " ", "]"}], "-", "1"}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766173495360677*^9, 3.7661735646375465`*^9}, {
  3.7661740527076983`*^9, 3.766174096833743*^9}, {3.7661741366484365`*^9, 
  3.7661741395388265`*^9}, {3.766174173677554*^9, 3.7661741742419634`*^9}, {
  3.7661745534022655`*^9, 3.7661745894624033`*^9}, {3.766174738884039*^9, 
  3.766174762853978*^9}, {3.766176158706545*^9, 3.7661761778263755`*^9}, {
  3.766176241130987*^9, 3.766176293551489*^9}, {3.7667682831145697`*^9, 
  3.7667682833825817`*^9}, {3.766768511490551*^9, 3.7667685116596627`*^9}, {
  3.7667687721705666`*^9, 3.7667688034988256`*^9}, {3.767364514296425*^9, 
  3.7673645203627324`*^9}, {3.7673663546122684`*^9, 3.767366371261894*^9}, {
  3.767375002629463*^9, 3.7673750047046337`*^9}, {3.7673752030920825`*^9, 
  3.767375218974571*^9}, {3.7676470055775414`*^9, 3.767647005733782*^9}}],

Cell["\<\
Cubed expression is the thermal de Broglie wavelength, \[Lambda]T = h / \
Sqrt[2 \[Pi] m k T]. m is the mass of a single particle (in this case, CO2 \
atom, kg). Note that \[Rho] is divided by N to get the density of molecules, \
not segments.
7.31*^-26 kg is the mass of a carbon dioxide atom (44.01 amu). \
\>", "Text",
 CellChangeTimes->{{3.7661747732541103`*^9, 3.7661748095980577`*^9}, 
   3.7667617533495283`*^9, {3.7667682880081244`*^9, 3.766768301580989*^9}, {
   3.7667685143311977`*^9, 3.766768516588797*^9}, {3.76735987296021*^9, 
   3.767359906421975*^9}, {3.7673651868060703`*^9, 3.7673652115042253`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of hard-sphere liquid", "Subsection",
 CellChangeTimes->{{3.7661741080583067`*^9, 3.766174157628705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fHS", "[", 
    RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"6", "/", "\[Pi]"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", " ", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "1"}], 
          "]"}], 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
          "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
          "]"}], ")"}], "^", "3"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
          "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "2"}], "]"}], ")"}], "^", "3"}], "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "2"}]}], "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "0"}], 
          "]"}]}], ")"}], 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
          "]"}]}], "]"}]}]}], " ", ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766174160022661*^9, 3.766174171388861*^9}, {
  3.766174256683544*^9, 3.766174449311809*^9}, {3.766174502081717*^9, 
  3.766174505141653*^9}, {3.7661748429549804`*^9, 3.7661748456350355`*^9}, {
  3.76684284471607*^9, 3.7668429263459635`*^9}, {3.7668431280872355`*^9, 
  3.766843183383767*^9}, {3.7670252913868036`*^9, 3.767025319235235*^9}, {
  3.7676467435289316`*^9, 3.7676467947352676`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of association", "Subsection",
 CellChangeTimes->{{3.766174906096306*^9, 3.7661749100152345`*^9}, 
   3.767456177258705*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gCO2", "[", 
     RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
         "]"}]}], ")"}]}], "+", " ", 
     RowBox[{"3", 
      RowBox[{"\[Xi]", "[", 
       RowBox[{
       "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
       "]"}], " ", 
      RowBox[{"dCO2", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
         "]"}], ")"}], "^", "2"}], 
      RowBox[{
       RowBox[{"dCO2", "^", "2"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "3"}]}], ")"}]}]}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gC5", "[", 
     RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
         "]"}]}], ")"}]}], "+", " ", 
     RowBox[{"3", 
      RowBox[{"\[Xi]", "[", 
       RowBox[{
       "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
       "]"}], " ", 
      RowBox[{"dC5", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
         "]"}], ")"}], "^", "2"}], 
      RowBox[{
       RowBox[{"dC5", "^", "2"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "3"}]}], ")"}]}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "radial", " ", "pair", " ", "distribution", " ", "function", " ", "for", 
     " ", "segments", " ", "of", " ", "component", " ", "i", " ", "in", " ", 
     "the", " ", "hard"}], "-", 
    RowBox[{"sphere", " ", "system"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.767646874280116*^9, 3.7676468969687123`*^9}, {
  3.76764693491737*^9, 3.767646989978024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fAssoc", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "NCO2_", 
     ",", "NC5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"NCO2", "-", "1"}], ")"}]}], "/", "NCO2"}], " ", "\[Rho]CO2", 
     " ", 
     RowBox[{"Log", "[", 
      RowBox[{"gCO2", "[", 
       RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5"}], "]"}],
       "]"}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"NC5", "-", "1"}], ")"}], "/", "NC5"}], " ", "\[Rho]C5", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"gC5", "[", 
       RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5"}], "]"}],
       "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7661749496877813`*^9, 3.766175019246869*^9}, {
  3.7661764607830925`*^9, 3.7661764676288548`*^9}, {3.7668429554123163`*^9, 
  3.7668429630468483`*^9}, {3.7668430800440617`*^9, 3.766843086995576*^9}, {
  3.76684326075173*^9, 3.766843268420308*^9}, {3.7676468321749916`*^9, 
  3.767646853550206*^9}, {3.7676471798747854`*^9, 3.767647215157135*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of dispersion", "Subsection",
 CellChangeTimes->{{3.766175210819456*^9, 3.7661752339640107`*^9}}],

Cell["\<\
First, load the constants for the polynomial approximation of the integrals \
I1 and I2 in Gross and Sadowski (2001). We refer to them here as J1 and J2 \
according to the nomenclature used by Xu et al. (2012).\
\>", "Text",
 CellChangeTimes->{{3.7668384978702345`*^9, 3.7668385859469624`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JConstants", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "\"\<J_integral_const_a_b.csv\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7664369419245267`*^9, 3.766436954757347*^9}, {
  3.7664376534873466`*^9, 3.766437653795168*^9}, {3.766438266219169*^9, 
  3.766438278987294*^9}, {3.7664383576049814`*^9, 3.7664384019099617`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a0", "=", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "3"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b0", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "5"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "6"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "7"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7664384033871202`*^9, 3.7664384693527374`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J1", "[", 
   RowBox[{
   "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "Nbar_"}], 
   "]"}], ":=", 
  RowBox[{"Sum", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a0", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"a1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "2"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"a2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{
        "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
        "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "[", 
   RowBox[{
   "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "Nbar_"}], 
   "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b0", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"b1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "2"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"b2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{
        "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
        "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.7661752374026213`*^9, 3.7661752430499077`*^9}, {
  3.766176373765312*^9, 3.7661765329294624`*^9}, {3.7661765909205303`*^9, 
  3.766176601720431*^9}, {3.7661766334367704`*^9, 3.7661766690852737`*^9}, {
  3.766436041192528*^9, 3.7664360657014275`*^9}, {3.766438635617507*^9, 
  3.7664387304939384`*^9}, {3.7664565272634487`*^9, 3.766456528545709*^9}, {
  3.7664569266507397`*^9, 3.766456933414873*^9}, {3.7673749155587687`*^9, 
  3.767374920502219*^9}, {3.7676472556900625`*^9, 3.7676473176833763`*^9}, {
  3.767647406235879*^9, 3.767647450926058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{
     "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", 
      "Nbar_"}], "]"}], ":=", 
    RowBox[{"1", "+", 
     RowBox[{"Nbar", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{
           "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
           "]"}]}], " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "2"}]}]}], ")"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{
           "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
           "]"}]}], ")"}], "^", "4"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "Nbar"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20", " ", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{
           "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
           "]"}]}], " ", "-", " ", 
         RowBox[{"27", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "2"}]}], " ", "+", " ", 
         RowBox[{"12", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "3"}]}], " ", "-", " ", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "4"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}]}]}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.766438737231091*^9, 3.766438737553897*^9}, {
  3.7664387977801*^9, 3.7664388990277867`*^9}, {3.7664389611692085`*^9, 
  3.7664389617378836`*^9}, {3.7664565195138807`*^9, 3.7664565239123616`*^9}, {
  3.766457962604103*^9, 3.7664579642781477`*^9}, {3.7668432020485735`*^9, 
  3.7668432221504908`*^9}, {3.767360280922468*^9, 3.7673603229207735`*^9}, {
  3.767360456474064*^9, 3.767360505896178*^9}, {3.7676474681235685`*^9, 
  3.7676475393408766`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]ij", "[", 
    RowBox[{"\[Epsilon]i_", ",", "\[Epsilon]j_", ",", "kij_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"\[Epsilon]i", " ", "\[Epsilon]j"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "kij"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]ij", "[", 
    RowBox[{"\[Sigma]i_", ",", "\[Sigma]j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Sigma]i", "+", "\[Sigma]j"}], ")"}], "/", "2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.767647838912354*^9, 3.7676478717031813`*^9}, {
  3.767648000032666*^9, 3.767648016246517*^9}, {3.767648307166321*^9, 
  3.7676483085139723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]fDisp", "[", 
   RowBox[{
   "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
    ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5_", ",", "Nbar_",
     ",", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], " ", 
     RowBox[{"\[Rho]CO2", "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"J1", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", "\[Beta]", " ", "\[Epsilon]CO2"}], " ", 
       "+", " ", 
       RowBox[{
        RowBox[{"Nbar", " ", "/", 
         RowBox[{"M", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}]}], " ", 
        RowBox[{"J2", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Beta]", " ", "\[Epsilon]CO2"}], ")"}], "^", "2"}]}]}], 
      ")"}], " ", 
     RowBox[{"\[Sigma]CO2", "^", "3"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], " ", 
     RowBox[{"\[Rho]C5", "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"J1", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", "\[Beta]", " ", "\[Epsilon]C5"}], " ", 
       "+", " ", 
       RowBox[{
        RowBox[{"Nbar", " ", "/", 
         RowBox[{"M", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}]}], " ", 
        RowBox[{"J2", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Beta]", " ", "\[Epsilon]C5"}], ")"}], "^", "2"}]}]}], 
      ")"}], " ", 
     RowBox[{"\[Sigma]C5", "^", "3"}]}], ")"}], "+", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], " ", "\[Rho]CO2", " ", "\[Rho]C5", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"J1", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}], " ", "\[Beta]", " ", 
         RowBox[{"\[Epsilon]ij", "[", 
          RowBox[{"\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5"}], 
          "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Nbar", " ", "/", 
          RowBox[{"M", "[", 
           RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
            RowBox[{"d", "[", 
             RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
             "]"}], ",", 
            RowBox[{"d", "[", 
             RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
             "]"}], ",", "Nbar"}], "]"}]}], " ", 
         RowBox[{"J2", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Beta]", " ", 
            RowBox[{"\[Epsilon]ij", "[", 
             RowBox[{"\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5"}], 
             "]"}]}], ")"}], "^", "2"}]}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Sigma]ij", "[", 
         RowBox[{"\[Sigma]CO2", ",", "\[Sigma]C5"}], "]"}], ")"}], "^", 
       "3"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.766842721977187*^9, 3.766842734394769*^9}, {
  3.766843036334453*^9, 3.766843040136225*^9}, {3.767374924454935*^9, 
  3.7673749320444775`*^9}, {3.7676475518473473`*^9, 3.7676478362487435`*^9}, {
  3.767647880027646*^9, 3.7676478954882793`*^9}, {3.7676479770440016`*^9, 
  3.7676479971910334`*^9}, {3.767648034651396*^9, 3.767648046259884*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total Free Energy", "Subsection",
 CellChangeTimes->{{3.7664391165434985`*^9, 3.7664391199245777`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Nbar", "[", 
    RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "NCO2_", ",", "NC5_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NCO2", " ", "\[Rho]CO2"}], " ", "+", 
      RowBox[{"NC5", " ", "\[Rho]C5"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Rho]CO2", "+", "\[Rho]C5"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kij", "[", 
    RowBox[{"ka_", ",", "kb_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{"ka", " ", "+", " ", 
    RowBox[{"kb", "/", "\[Beta]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76764808347503*^9, 3.7676481448206277`*^9}, {
  3.767648310804928*^9, 3.767648335251751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]f", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]fIG", "[", 
     RowBox[{"\[Rho]CO2", ",", "NCO2"}], "]"}], "+", 
    RowBox[{"\[Beta]fIG", "[", 
     RowBox[{"\[Rho]C5", ",", "NC5"}], "]"}], "+", 
    RowBox[{"\[Beta]fHS", "[", 
     RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], "]"}], 
      ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}]}], 
     "]"}], "+", 
    RowBox[{"\[Beta]fAssoc", "[", 
     RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], "]"}], 
      ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}], 
      ",", "NCO2", ",", "NC5"}], "]"}], "+", 
    RowBox[{"\[Beta]fDisp", "[", 
     RowBox[{
     "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", ",",
       "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
      RowBox[{"kij", "[", 
       RowBox[{"kCO2C5a", ",", "kCO2C5b", ",", "\[Beta]"}], "]"}], ",", 
      RowBox[{"Nbar", "[", 
       RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", "NCO2", ",", "NC5"}], "]"}],
       ",", "\[Beta]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766439121586608*^9, 3.7664391818260727`*^9}, {
   3.7667608794334183`*^9, 3.7667608797155128`*^9}, {3.766760944405161*^9, 
   3.7667609445744133`*^9}, {3.766761084729862*^9, 3.76676112874378*^9}, {
   3.7667611775401335`*^9, 3.7667611802824593`*^9}, {3.7667613419661603`*^9, 
   3.7667613421134043`*^9}, {3.766762115229057*^9, 3.766762118740593*^9}, {
   3.766762161555049*^9, 3.7667621874479475`*^9}, {3.76683866472351*^9, 
   3.766838733559309*^9}, {3.766840000442275*^9, 3.7668400052743864`*^9}, {
   3.7668432395832357`*^9, 3.7668432488361473`*^9}, 3.7668432821412945`*^9, {
   3.767375225112522*^9, 3.767375225261249*^9}, {3.767456709983477*^9, 
   3.7674567803852024`*^9}, {3.7674568413798256`*^9, 
   3.7674568565273237`*^9}, {3.7676468044953814`*^9, 
   3.7676468125346613`*^9}, {3.7676480626766253`*^9, 
   3.7676480743330355`*^9}, {3.7676481586257334`*^9, 
   3.7676482287378445`*^9}, {3.767648290737876*^9, 3.7676482987439637`*^9}, {
   3.767648343777483*^9, 3.7676483699702845`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chemical potential", "Subsection",
 CellChangeTimes->{{3.7664392169199877`*^9, 3.766439222786623*^9}, {
   3.7664394123047304`*^9, 3.766439424689309*^9}, 3.7664572709226704`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Mu]CO2", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]f", "[", 
       RowBox[{
       "\[Rho]CO2prime", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], ",", "\[Rho]CO2prime"}], "]"}], "/.", 
    RowBox[{"\[Rho]CO2prime", "\[Rule]", "\[Rho]CO2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Mu]C5", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]f", "[", 
       RowBox[{
       "\[Rho]CO2", ",", "\[Rho]C5prime", ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], ",", "\[Rho]C5prime"}], "]"}], "/.", 
    RowBox[{"\[Rho]C5prime", "\[Rule]", "\[Rho]C5"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667606020409293`*^9, 3.7667606640878563`*^9}, {
  3.7667607091182785`*^9, 3.766760714617767*^9}, {3.7676483855108457`*^9, 
  3.7676484424766307`*^9}, {3.767648525710697*^9, 3.76764854345258*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pressure", "Subsection",
 CellChangeTimes->{{3.7664394281193423`*^9, 3.766439446366357*^9}, {
  3.7664570995752974`*^9, 3.7664571002089205`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]p", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Beta]f", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", 
       ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", 
       "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], "+", 
    RowBox[{"\[Rho]CO2", " ", 
     RowBox[{"\[Beta]\[Mu]CO2", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", 
       ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", 
       "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], "+", 
    RowBox[{"\[Rho]C5", " ", 
     RowBox[{"\[Beta]\[Mu]C5", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", 
       ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", 
       "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76645711433683*^9, 3.766457147062825*^9}, {
  3.766457504081125*^9, 3.766457557203376*^9}, {3.7664583213730125`*^9, 
  3.7664583409633703`*^9}, {3.766458746680251*^9, 3.766458767119524*^9}, {
  3.7664588906435037`*^9, 3.766458892519684*^9}, {3.767648450928343*^9, 
  3.7676484983911085`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Plot", "Section",
 CellChangeTimes->{{3.766457570078002*^9, 3.766457575486906*^9}}],

Cell["\<\
Nondimensionalize length by \[Sigma]CO2, the size of a carbon dioxide bead \
(2.79 A). Parameters were obtained from \
20180426_Huikuan_summary_ternary_syst.ppt\
\>", "Text",
 CellChangeTimes->{{3.7677516152418175`*^9, 3.767751640844433*^9}, {
  3.7677518752645917`*^9, 3.767751890690878*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kB", "=", "1.38065*^-23"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Boltzmann", " ", 
    RowBox[{"constant", " ", "[", 
     RowBox[{"J", "/", "K"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", "291"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"temperature", " ", "[", "K", "]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Beta]Param", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"kB", " ", "T"}], ")"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"beta", " ", 
    RowBox[{"parameter", " ", "[", 
     RowBox[{"1", "/", "J"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NCO2", "=", "2"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "number", " ", "of", " ", "beads", " ", "used", " ", "to", " ", "model", 
    " ", "CO2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Epsilon]CO2", "=", 
   RowBox[{"170.5", " ", "kB"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"attractive", " ", "well", " ", "depth"}], ",", " ", 
    RowBox[{"from", " ", "Xu", " ", "et", " ", 
     RowBox[{"al", ".", " ", "2012"}], " ", 
     RowBox[{"JCP", " ", "[", "J", "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]CO2", "=", " ", "2.79*^-10"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"bead", " ", 
    RowBox[{"size", " ", "[", "m", "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]CO2Ref", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "use", " ", "bead", " ", "size", " ", "as", " ", "reference", " ", 
    "length", " ", "for", " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NC5", " ", "=", " ", "2"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
    "number", " ", "of", " ", "beads", " ", "used", " ", "to", " ", "model", 
     " ", "C5H10"}], ")"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]C5", "=", "3.92"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]C5Ref", " ", "=", " ", 
   RowBox[{"\[Sigma]C5", "/", "\[Sigma]CO2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]C5", "=", 
   RowBox[{"289.82", "kB"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kCO2C5a", "=", "0.125"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "constant", " ", "parameter", " ", "for", " ", "temperature", " ", 
    "dependence", " ", "of", " ", 
    RowBox[{"interaction", " ", "[", "J", "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"kCO2C5b", "=", 
   RowBox[{"-", "2.903*^-6"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "coefficient", " ", "of", " ", "temperature", " ", "for", " ", 
    "temperature", " ", "dependence", " ", "of", " ", 
    RowBox[{"interaction", " ", "[", 
     RowBox[{"J", "/", "K"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Rho]C5", "=", "10"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"density", " ", "of", " ", 
    RowBox[{"cyclopentane", " ", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Rho]CO2min", "=", "0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"minimum", " ", "mass", " ", "density", " ", "to", " ", 
    RowBox[{"plot", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Rho]CO2max", " ", "=", " ", "1100"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"maximum", " ", "mass", " ", "density", " ", "to", " ", 
    RowBox[{"plot", " ", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MBeadCO2", "=", " ", 
   RowBox[{"0.044", "/", "NCO2"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "molar", " ", "mass", " ", "of", " ", "one", " ", "bead", " ", "of", " ", 
    "carbon", " ", 
    RowBox[{"dioxide", " ", "[", 
     RowBox[{"kg", "/", "mol"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MBeadC5", "=", " ", 
   RowBox[{"0.071", "/", "NCO2"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "molar", " ", "mass", " ", "of", " ", "one", " ", "bead", " ", "of", " ", 
    RowBox[{"cyclopentane", " ", "[", 
     RowBox[{"kg", "/", "mol"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NA", " ", "=", " ", "6.022*^23"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Avogadro", "'"}], "s", " ", 
    RowBox[{"number", " ", "[", 
     RowBox[{"molecules", "/", "mol"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Rho]CO2Conv", "=", 
   RowBox[{
    RowBox[{"\[Sigma]CO2", "^", "3"}], "*", 
    RowBox[{"NA", "/", "MBeadCO2"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convert", " ", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"molecules", "/", 
     RowBox[{"\[Sigma]CO2", "^", "3"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Rho]C5Conv", "=", 
   RowBox[{
    RowBox[{"\[Sigma]CO2", "^", "3"}], "*", 
    RowBox[{"NA", "/", "MBeadC5"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convert", " ", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"molecules", "/", 
     RowBox[{"\[Sigma]CO2", "^", "3"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Pa2MPa", " ", "=", " ", "1*^-6"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"multiplicative", " ", "conversion", " ", "from", " ", "Pa"}], 
    " ", "\[Rule]", " ", "MPa"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"pConv", " ", "=", " ", 
   RowBox[{"Pa2MPa", "*", 
    RowBox[{"\[Beta]Param", "^", 
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}]}], "*", 
    RowBox[{"\[Sigma]CO2", "^", 
     RowBox[{"(", 
      RowBox[{"-", "3"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7664591936153975`*^9, 3.766459248347232*^9}, 
   3.766624476976756*^9, {3.76662720945208*^9, 3.7666273494900618`*^9}, {
   3.7666273859603004`*^9, 3.7666273974370823`*^9}, {3.766627452208065*^9, 
   3.7666275948992662`*^9}, {3.76662786647266*^9, 3.7666278834680777`*^9}, {
   3.76676073771898*^9, 3.766760780433696*^9}, {3.766761024018258*^9, 
   3.7667610248958206`*^9}, {3.7667612138696575`*^9, 3.76676132635797*^9}, {
   3.766762070305524*^9, 3.7667620929160414`*^9}, {3.7667621312693715`*^9, 
   3.766762151021905*^9}, {3.766768111232124*^9, 3.7667682752769012`*^9}, {
   3.766768323142599*^9, 3.766768323392592*^9}, {3.7667685026193175`*^9, 
   3.7667685038571196`*^9}, {3.7667687821597385`*^9, 
   3.7667687827561903`*^9}, {3.7667688690894623`*^9, 3.766768886711793*^9}, {
   3.766768966321562*^9, 3.7667689763525505`*^9}, {3.7667690504873285`*^9, 
   3.7667690520154223`*^9}, {3.766841236834464*^9, 3.766841298106201*^9}, {
   3.766841414759708*^9, 3.766841415156062*^9}, {3.7668416585292587`*^9, 
   3.7668416670358143`*^9}, {3.7668417299185967`*^9, 
   3.7668417830632424`*^9}, {3.7668418836475887`*^9, 3.766841940273589*^9}, {
   3.766842039604266*^9, 3.766842040470434*^9}, {3.7668425644026303`*^9, 
   3.766842585199622*^9}, {3.7668437565206966`*^9, 3.7668437643884916`*^9}, {
   3.7670130880822973`*^9, 3.767013105478735*^9}, {3.7670251893747478`*^9, 
   3.767025189755666*^9}, {3.767364297945385*^9, 3.7673643229792128`*^9}, {
   3.767366451076212*^9, 3.7673664936360264`*^9}, {3.7673665372417355`*^9, 
   3.7673665387229147`*^9}, {3.7673750435401344`*^9, 
   3.7673750706586685`*^9}, {3.767375368952506*^9, 3.7673754393884172`*^9}, {
   3.7673754985795546`*^9, 3.7673755235951304`*^9}, {3.7673755815413866`*^9, 
   3.7673755876932287`*^9}, {3.7673756378214974`*^9, 
   3.7673757111780515`*^9}, {3.7673757942251964`*^9, 
   3.7673758366324706`*^9}, {3.767376326198023*^9, 3.7673763732391396`*^9}, {
   3.7674071044645166`*^9, 3.767407148463358*^9}, {3.7674558230630198`*^9, 
   3.7674558407096605`*^9}, {3.767456091739439*^9, 3.767456091850152*^9}, {
   3.7677509616751127`*^9, 3.7677509719615183`*^9}, {3.7677510459710927`*^9, 
   3.7677511989925623`*^9}, {3.767751357542054*^9, 3.7677514173539195`*^9}, {
   3.767751453756855*^9, 3.7677514544287734`*^9}, {3.7677515848002143`*^9, 
   3.7677516020257254`*^9}, {3.767751701722649*^9, 3.7677517518992023`*^9}, {
   3.767751789521467*^9, 3.7677517983515697`*^9}, {3.767751869895677*^9, 
   3.7677518700476413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]p", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2Ref", ",", 
       "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
       "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", 
       "\[Beta]Param"}], "]"}], "*", "pConv"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Rho]CO2", ",", "\[Rho]CO2min", ",", " ", "\[Rho]CO2max"}], 
     "}"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<density (molecules/\[Sigma]CO2^3)\>\"", ",", 
       "\"\<pressure (MPa)\>\""}], "}"}]}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7668413436808233`*^9, 3.766841343846241*^9}, {
   3.766841784963161*^9, 3.7668417889315233`*^9}, {3.766842701872473*^9, 
   3.766842704495473*^9}, {3.766843584816844*^9, 3.766843712396203*^9}, {
   3.767366520603008*^9, 3.767366533508975*^9}, {3.7673750747800617`*^9, 
   3.7673750881381173`*^9}, {3.767375401723072*^9, 3.767375402035696*^9}, {
   3.767375561166444*^9, 3.767375606044939*^9}, {3.767375646590478*^9, 
   3.767375652254295*^9}, {3.7673757548665485`*^9, 3.7673757621505704`*^9}, {
   3.76737637093769*^9, 3.767376396715935*^9}, 3.767456084887969*^9, {
   3.767751675498639*^9, 3.767751718821533*^9}, {3.7677517584584885`*^9, 
   3.7677517588449793`*^9}, {3.767751857917576*^9, 3.7677518606923227`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.76775189529946*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.76775189530346*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7677518953074584`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7677518953114567`*^9}],

Cell[BoxData[
 GraphicsBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQfX5JjaJU13c7BihQDloamjfd1AHG/xW0qudpvRuc
X3tJP+TwtgA4X5vRolhZKAzOPyXxunv/w2g437rpWAPX8gQ4v+tNjkXw9GQ4
f4Pkqh2PK9Pg/Dsb4p5f0MqE8xv2vBC6I5oD52sZvXrjfD4Pzg8zPXi8cm8B
nH+Zu2J6gkERnB88PWtfaVcxnM9/9/jjmYylcL55S8Hbh4VlcH7SgxC/iJPl
cP7Jb4vX3rWthPOND+mlTJxZBeffdFeRDBGqgfNf66VusmqphfMZTj9c5H+3
Ds5fOeHJiZ2aDQj3iX17nXQDwd/so8s4r7kRzjd8MHNqgm0TnG/gtyR01ysE
30/yyZTZy5rhfMWpnsf44lvg/LLXPsqS3K1w/st5rf9XHUXw7+nEsF8pboPz
O7IjGPvl2uH8APauqovXEfxZtZHyq1s64HymwDhnHodOOP/NP4bJLO8R/O7Y
k1f6ZnXB+Z6Sx6cuCOlG2Lc+qcmTqQfOf7rI+F3lPgT/h5uWj015L5zfc3Tf
1anKfXC+/cKOe2X3EPzi8A9C73v64Xy9+/vm/JGeAOcbOi7IP1qB4JdOCLgR
eR7Br6iU/fVffyKcDwB19r3S
   "], {}],
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{
    FormBox["\"density (molecules/\[Sigma]CO2^3)\"", TraditionalForm], 
    FormBox["\"pressure (MPa)\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  PlotRange->{{0, 1100}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.7667616636590643`*^9, 3.7667616792007785`*^9}, {
   3.766762075244031*^9, 3.7667620861521673`*^9}, {3.76676212714094*^9, 
   3.7667621775412474`*^9}, {3.7667681170950747`*^9, 
   3.7667682512839003`*^9}, {3.7667683132139072`*^9, 
   3.7667683261403975`*^9}, {3.7667687771570597`*^9, 
   3.7667688080922785`*^9}, {3.7667688728345375`*^9, 
   3.7667688807376375`*^9}, {3.7667689571111403`*^9, 3.7667689799741173`*^9}, 
   3.766769014110639*^9, {3.7668386919551425`*^9, 3.7668387417545805`*^9}, 
   3.7668400179191637`*^9, 3.766840076129553*^9, 3.766841315216074*^9, 
   3.7668413524994774`*^9, 3.766841431586795*^9, {3.7668416608342094`*^9, 
   3.766841668776707*^9}, {3.766841732260189*^9, 3.7668417477522936`*^9}, {
   3.76684186355667*^9, 3.7668419414468765`*^9}, {3.7668425755246496`*^9, 
   3.7668425896674395`*^9}, 3.7668433034518585`*^9, 3.76684344463875*^9, {
   3.7668436673382983`*^9, 3.766843727685283*^9}, 3.7668437587156634`*^9, {
   3.7670130949901094`*^9, 3.7670131091771045`*^9}, 3.767025194264166*^9, 
   3.767025324355248*^9, {3.7673604623041487`*^9, 3.767360488803832*^9}, 
   3.7673642881823077`*^9, 3.767364327368361*^9, 3.7673645569761944`*^9, 
   3.767366254487407*^9, 3.7673663624473104`*^9, {3.7673664352423716`*^9, 
   3.7673665274214554`*^9}, 3.7673749431341352`*^9, 3.7673750139428215`*^9, 
   3.7673750926644278`*^9, 3.7673752339795694`*^9, 3.7673753764232316`*^9, 
   3.7673756135548987`*^9, {3.7673756560742693`*^9, 3.767375714299226*^9}, 
   3.7673757653981905`*^9, {3.7673758267298098`*^9, 3.767375841772524*^9}, 
   3.7673763810237803`*^9, {3.7674071097462254`*^9, 3.76740713348602*^9}, 
   3.76745583123678*^9, {3.7674558759186764`*^9, 3.7674559030176497`*^9}, {
   3.767751770444449*^9, 3.7677518072254868`*^9}, 3.7677518957833385`*^9}]
}, Open  ]],

Cell["Plot in terms of kg/m^3", "Text",
 CellChangeTimes->{{3.76702547264328*^9, 3.7670254760317883`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Numerical Solving", "Section",
 CellChangeTimes->{{3.766171239583239*^9, 3.7661712519377613`*^9}}],

Cell[CellGroupData[{

Cell["Critical Point", "Subsection",
 CellChangeTimes->{{3.766839754582593*^9, 3.7668397558509445`*^9}}],

Cell["\<\
Occurs where both first and second derivatives of pressure with respect to \
density are 0.\
\>", "Text",
 CellChangeTimes->{{3.766839760020883*^9, 3.7668397618747854`*^9}, {
  3.7668398409774218`*^9, 3.7668398505418897`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Beta]p", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref", 
          ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"kB", " ", "Tc"}], ")"}]}], ",", "\[Epsilon]CO2"}], "]"}],
         ",", "\[Rho]"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref", 
            ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"kB", " ", "Tc"}], ")"}]}], ",", "\[Epsilon]CO2"}], 
           "]"}], ",", "\[Rho]"}], "]"}], ",", "\[Rho]"}], "]"}], "\[Equal]", 
      "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "Tc"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7668398524088993`*^9, 3.7668399446859894`*^9}, {
   3.7668399771740246`*^9, 3.7668399933873177`*^9}, 3.766843328080162*^9, {
   3.7674071632982726`*^9, 3.7674071847422366`*^9}, {3.7674557945932255`*^9, 
   3.767455797824287*^9}, {3.7674558594101367`*^9, 3.7674558974899426`*^9}}],

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0005944710093545456`", " ", 
        RowBox[{
         SuperscriptBox["\[Beta]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          RowBox[{"0.0005944710093545456`", " ", "\[Rho]"}], ",", "1", ",", 
          FractionBox["7.24296526998153`*^22", "Tc"], ",", 
          "2.3540082500000002`*^-21"}], "]"}]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"0.0005944710093545456`", " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.0005944710093545456`", " ", 
          RowBox[{
           SuperscriptBox["\[Beta]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"0.0005944710093545456`", " ", "\[Rho]"}], ",", "1", ",", 
            FractionBox["7.24296526998153`*^22", "Tc"], ",", 
            "2.3540082500000002`*^-21"}], "]"}]}]}], ")"}]}], "\[Equal]", 
      "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "Tc"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7674081289726954`*^9, {3.7674558522628255`*^9, 3.7674558764342637`*^9}, 
   3.7674560678037496`*^9, {3.7677517706940193`*^9, 3.767751807297488*^9}, 
   3.767751895971389*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["\<\
3. Sanity Checks (thermodynamic relations)\
\>", "Section",
 CellChangeTimes->{{3.7661712564080143`*^9, 3.766171272863637*^9}}]
}, Open  ]]
},
WindowSize->{1264, 583},
WindowMargins->{{-12, Automatic}, {Automatic, 9}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 102, 1, 83, "Title"],
Cell[684, 25, 158, 3, 49, "Subtitle"],
Cell[845, 30, 190, 4, 28, "Subsubtitle"],
Cell[1038, 36, 98, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[1161, 41, 95, 1, 41, "Section"],
Cell[1259, 44, 684, 14, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1980, 63, 97, 1, 71, "Section"],
Cell[2080, 66, 774, 21, 31, "Input"],
Cell[2857, 89, 245, 5, 29, "Text"],
Cell[3105, 96, 657, 19, 52, "Input"],
Cell[CellGroupData[{
Cell[3787, 119, 361, 5, 36, "Subsection"],
Cell[4151, 126, 1145, 22, 31, "Input"],
Cell[5299, 150, 628, 10, 47, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5964, 165, 123, 1, 36, "Subsection"],
Cell[6090, 168, 2911, 79, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9038, 252, 142, 2, 36, "Subsection"],
Cell[9183, 256, 3486, 104, 112, "Input"],
Cell[12672, 362, 1181, 30, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13890, 397, 115, 1, 36, "Subsection"],
Cell[14008, 400, 304, 5, 29, "Text"],
Cell[14315, 407, 471, 10, 31, "Input"],
Cell[14789, 419, 1420, 48, 132, "Input"],
Cell[16212, 469, 3006, 85, 92, "Input"],
Cell[19221, 556, 3178, 87, 72, "Input"],
Cell[22402, 645, 733, 20, 52, "Input"],
Cell[23138, 667, 5671, 137, 192, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28846, 809, 109, 1, 36, "Subsection"],
Cell[28958, 812, 728, 21, 52, "Input"],
Cell[29689, 835, 2605, 52, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32331, 892, 184, 2, 36, "Subsection"],
Cell[32518, 896, 1733, 38, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34288, 939, 151, 2, 36, "Subsection"],
Cell[34442, 943, 1560, 33, 72, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36051, 982, 92, 1, 71, "Section"],
Cell[36146, 985, 303, 6, 29, "Text"],
Cell[36452, 993, 8375, 185, 472, "Input"],
Cell[CellGroupData[{
Cell[44852, 1182, 1424, 28, 52, "Input"],
Cell[46279, 1212, 446, 10, 40, "Message"],
Cell[46728, 1224, 446, 10, 40, "Message"],
Cell[47177, 1236, 449, 10, 40, "Message"],
Cell[47629, 1248, 530, 11, 21, "Message"],
Cell[48162, 1261, 2876, 49, 175, "Output"]
}, Open  ]],
Cell[51053, 1313, 106, 1, 29, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51196, 1319, 107, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[51328, 1324, 104, 1, 36, "Subsection"],
Cell[51435, 1327, 236, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[51696, 1336, 1341, 35, 31, "Input"],
Cell[53040, 1373, 1607, 41, 95, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[54686, 1419, 137, 3, 71, "Section"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
