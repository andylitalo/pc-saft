(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    119754,       3091]
NotebookOptionsPosition[    114005,       2902]
NotebookOutlinePosition[    114352,       2917]
CellTagsIndexPosition[    114309,       2914]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["CO2 Phase Diagram", "Title",
 CellChangeTimes->{{3.766171115195342*^9, 3.7661711186790104`*^9}}],

Cell["\<\
PC-SAFT (Perturbed-Chain Statistical Associating Fluid Theory)\
\>", "Subtitle",
 CellChangeTimes->{{3.766171121135342*^9, 3.7661711344505033`*^9}}],

Cell["\<\
Andy Ylitalo, with guidance from Dr. Huikuan Chao and mentorship from Prof. \
Zhen-Gang Wang\
\>", "Subsubtitle",
 CellChangeTimes->{{3.76617114052406*^9, 3.7661711558771763`*^9}}],

Cell["Questions", "Section",
 CellChangeTimes->{{3.7667685253386035`*^9, 3.7667685299100657`*^9}}],

Cell[CellGroupData[{

Cell["0. Setup", "Section",
 CellChangeTimes->{{3.7664366427323756`*^9, 3.766436646161707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "\"\<C:\>\"", ",", "\"\<Users\>\"", ",", "\"\<Andy.DESKTOP-CFRG05F\>\"", 
      ",", "\"\<OneDrive - California Institute of Technology\>\"", ",", " ", 
      "\"\<Documents\>\"", ",", " ", "\"\<Research\>\"", ",", " ", 
      "\"\<Wang\>\"", ",", " ", "\"\<PC-SAFT\>\""}], "}"}], "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766436649632274*^9, 3.7664367319724555`*^9}, {
   3.766437154420802*^9, 3.7664372330614023`*^9}, {3.766437450288994*^9, 
   3.7664374718696346`*^9}, 3.766437523104933*^9, {3.766437596139181*^9, 
   3.766437635410695*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Equations", "Section",
 CellChangeTimes->{{3.766171165943899*^9, 3.766171173160204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"\[Sigma]_", ",", "\[Beta]_", ",", "\[Epsilon]_"}], "]"}], ":=", 
    RowBox[{"\[Sigma]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"0.12", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "\[Epsilon]", " ", "\[Beta]"}], "]"}]}]}], 
      ")"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temperature", "-", 
     RowBox[{"dependent", " ", "particle", " ", "diameter"}]}], ",", " ", 
    RowBox[{"Gross", " ", "and", " ", "Sadowski", " ", 
     RowBox[{"(", "2001", ")"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7668427841617417`*^9, 3.766842831233387*^9}, {
  3.7668434766043406`*^9, 3.7668434768230743`*^9}}],

Cell["\<\
Note that \[Xi][\[Rho],\[Sigma],3] represents the total packing fraction and \
is therefore dimensionless. In general, \[Xi][\[Rho],\[Sigma],n] has \
dimensions of (length)^(n-3).\
\>", "Text",
 CellChangeTimes->{
  3.767456168681527*^9, {3.768092855816022*^9, 3.768092857837695*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Xi]", "[", 
     RowBox[{
     "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "j_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "6"}], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"\[Rho]CO2", " ", 
        RowBox[{"dCO2", "^", "j"}]}], " ", "+", " ", 
       RowBox[{"\[Rho]C5", " ", 
        RowBox[{"dC5", "^", "j"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7674561303420353`*^9, 3.7674561306448402`*^9}, {
  3.767456801082348*^9, 3.7674568222303095`*^9}, {3.767646861217755*^9, 
  3.767646864749775*^9}}],

Cell[CellGroupData[{

Cell["Free energy of ideal gas", "Subsection",
 CellChangeTimes->{{3.766171233515663*^9, 3.7661712341291666`*^9}, {
  3.766173490817514*^9, 3.766173493167342*^9}, {3.766174768164322*^9, 
  3.766174769834175*^9}, {3.7664390361034045`*^9, 3.766439036760029*^9}, {
  3.7666277515983553`*^9, 3.7666277647938395`*^9}, {3.766838373703772*^9, 
  3.76683837386001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fIG", "[", 
    RowBox[{"\[Rho]_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"\[Rho]", "/", "N"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"\[Rho]", " ", "/", "N"}], " ", "]"}], "-", "1"}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766173495360677*^9, 3.7661735646375465`*^9}, {
  3.7661740527076983`*^9, 3.766174096833743*^9}, {3.7661741366484365`*^9, 
  3.7661741395388265`*^9}, {3.766174173677554*^9, 3.7661741742419634`*^9}, {
  3.7661745534022655`*^9, 3.7661745894624033`*^9}, {3.766174738884039*^9, 
  3.766174762853978*^9}, {3.766176158706545*^9, 3.7661761778263755`*^9}, {
  3.766176241130987*^9, 3.766176293551489*^9}, {3.7667682831145697`*^9, 
  3.7667682833825817`*^9}, {3.766768511490551*^9, 3.7667685116596627`*^9}, {
  3.7667687721705666`*^9, 3.7667688034988256`*^9}, {3.767364514296425*^9, 
  3.7673645203627324`*^9}, {3.7673663546122684`*^9, 3.767366371261894*^9}, {
  3.767375002629463*^9, 3.7673750047046337`*^9}, {3.7673752030920825`*^9, 
  3.767375218974571*^9}, {3.7676470055775414`*^9, 3.767647005733782*^9}}],

Cell["\<\
Cubed expression is the thermal de Broglie wavelength, \[Lambda]T = h / \
Sqrt[2 \[Pi] m k T]. m is the mass of a single particle (in this case, CO2 \
atom, kg). Note that \[Rho] is divided by N to get the density of molecules, \
not segments.
7.31*^-26 kg is the mass of a carbon dioxide atom (44.01 amu). \
\>", "Text",
 CellChangeTimes->{{3.7661747732541103`*^9, 3.7661748095980577`*^9}, 
   3.7667617533495283`*^9, {3.7667682880081244`*^9, 3.766768301580989*^9}, {
   3.7667685143311977`*^9, 3.766768516588797*^9}, {3.76735987296021*^9, 
   3.767359906421975*^9}, {3.7673651868060703`*^9, 3.7673652115042253`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of hard-sphere liquid", "Subsection",
 CellChangeTimes->{{3.7661741080583067`*^9, 3.766174157628705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fHS", "[", 
    RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"6", "/", "\[Pi]"}], 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", " ", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "1"}], 
          "]"}], 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
          "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
          "]"}], ")"}], "^", "3"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
          "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "2"}], "]"}], ")"}], "^", "3"}], "/", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "2"}]}], "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "0"}], 
          "]"}]}], ")"}], 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{
          "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
          "]"}]}], "]"}]}]}], " ", ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766174160022661*^9, 3.766174171388861*^9}, {
  3.766174256683544*^9, 3.766174449311809*^9}, {3.766174502081717*^9, 
  3.766174505141653*^9}, {3.7661748429549804`*^9, 3.7661748456350355`*^9}, {
  3.76684284471607*^9, 3.7668429263459635`*^9}, {3.7668431280872355`*^9, 
  3.766843183383767*^9}, {3.7670252913868036`*^9, 3.767025319235235*^9}, {
  3.7676467435289316`*^9, 3.7676467947352676`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of association", "Subsection",
 CellChangeTimes->{{3.766174906096306*^9, 3.7661749100152345`*^9}, 
   3.767456177258705*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gCO2", "[", 
     RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
         "]"}]}], ")"}]}], "+", " ", 
     RowBox[{"3", 
      RowBox[{"\[Xi]", "[", 
       RowBox[{
       "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
       "]"}], " ", 
      RowBox[{"dCO2", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
         "]"}], ")"}], "^", "2"}], 
      RowBox[{
       RowBox[{"dCO2", "^", "2"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "3"}]}], ")"}]}]}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gC5", "[", 
     RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
         "]"}]}], ")"}]}], "+", " ", 
     RowBox[{"3", 
      RowBox[{"\[Xi]", "[", 
       RowBox[{
       "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
       "]"}], " ", 
      RowBox[{"dC5", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{
         "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "2"}], 
         "]"}], ")"}], "^", "2"}], 
      RowBox[{
       RowBox[{"dC5", "^", "2"}], " ", "/", " ", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "3"}]}], ")"}]}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "radial", " ", "pair", " ", "distribution", " ", "function", " ", "for", 
     " ", "segments", " ", "of", " ", "component", " ", "i", " ", "in", " ", 
     "the", " ", "hard"}], "-", 
    RowBox[{"sphere", " ", "system"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.767646874280116*^9, 3.7676468969687123`*^9}, {
  3.76764693491737*^9, 3.767646989978024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]fAssoc", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "NCO2_", 
     ",", "NC5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"NCO2", "-", "1"}], ")"}]}], "/", "NCO2"}], " ", "\[Rho]CO2", 
     " ", 
     RowBox[{"Log", "[", 
      RowBox[{"gCO2", "[", 
       RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5"}], "]"}],
       "]"}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"NC5", "-", "1"}], ")"}], "/", "NC5"}], " ", "\[Rho]C5", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"gC5", "[", 
       RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5"}], "]"}],
       "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7661749496877813`*^9, 3.766175019246869*^9}, {
  3.7661764607830925`*^9, 3.7661764676288548`*^9}, {3.7668429554123163`*^9, 
  3.7668429630468483`*^9}, {3.7668430800440617`*^9, 3.766843086995576*^9}, {
  3.76684326075173*^9, 3.766843268420308*^9}, {3.7676468321749916`*^9, 
  3.767646853550206*^9}, {3.7676471798747854`*^9, 3.767647215157135*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Free energy of dispersion", "Subsection",
 CellChangeTimes->{{3.766175210819456*^9, 3.7661752339640107`*^9}}],

Cell["\<\
First, load the constants for the polynomial approximation of the integrals \
I1 and I2 in Gross and Sadowski (2001). We refer to them here as J1 and J2 \
according to the nomenclature used by Xu et al. (2012).\
\>", "Text",
 CellChangeTimes->{{3.7668384978702345`*^9, 3.7668385859469624`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JConstants", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "\"\<J_integral_const_a_b.csv\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7664369419245267`*^9, 3.766436954757347*^9}, {
  3.7664376534873466`*^9, 3.766437653795168*^9}, {3.766438266219169*^9, 
  3.766438278987294*^9}, {3.7664383576049814`*^9, 3.7664384019099617`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a0", "=", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "3"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b0", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "5"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "6"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", 
   RowBox[{"JConstants", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], ",", " ", "7"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7664384033871202`*^9, 3.7664384693527374`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J1", "[", 
   RowBox[{
   "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "Nbar_"}], 
   "]"}], ":=", 
  RowBox[{"Sum", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a0", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"a1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "2"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"a2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{
        "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
        "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "a0", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "[", 
   RowBox[{
   "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", "Nbar_"}], 
   "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b0", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"b1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "1"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Nbar", "-", "2"}], ")"}], "/", "Nbar"}], " ", 
        RowBox[{"b2", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{
        "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
        "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "b0", "]"}]}], "}"}]}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.7661752374026213`*^9, 3.7661752430499077`*^9}, {
  3.766176373765312*^9, 3.7661765329294624`*^9}, {3.7661765909205303`*^9, 
  3.766176601720431*^9}, {3.7661766334367704`*^9, 3.7661766690852737`*^9}, {
  3.766436041192528*^9, 3.7664360657014275`*^9}, {3.766438635617507*^9, 
  3.7664387304939384`*^9}, {3.7664565272634487`*^9, 3.766456528545709*^9}, {
  3.7664569266507397`*^9, 3.766456933414873*^9}, {3.7673749155587687`*^9, 
  3.767374920502219*^9}, {3.7676472556900625`*^9, 3.7676473176833763`*^9}, {
  3.767647406235879*^9, 3.767647450926058*^9}, {3.7681539380797324`*^9, 
  3.768153940081663*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{
     "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "dCO2_", ",", "dC5_", ",", 
      "Nbar_"}], "]"}], ":=", 
    RowBox[{"1", "+", 
     RowBox[{"Nbar", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{
           "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
           "]"}]}], " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "2"}]}]}], ")"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{
           "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
           "]"}]}], ")"}], "^", "4"}]}]}], "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "Nbar"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20", " ", 
          RowBox[{"\[Xi]", "[", 
           RowBox[{
           "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", "3"}], 
           "]"}]}], " ", "-", " ", 
         RowBox[{"27", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "2"}]}], " ", "+", " ", 
         RowBox[{"12", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "3"}]}], " ", "-", " ", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}], ")"}], "^", "4"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{
             "\[Rho]CO2", ",", "\[Rho]C5", ",", "dCO2", ",", "dC5", ",", 
              "3"}], "]"}]}], ")"}], "^", "2"}]}], ")"}]}]}]}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.766438737231091*^9, 3.766438737553897*^9}, {
  3.7664387977801*^9, 3.7664388990277867`*^9}, {3.7664389611692085`*^9, 
  3.7664389617378836`*^9}, {3.7664565195138807`*^9, 3.7664565239123616`*^9}, {
  3.766457962604103*^9, 3.7664579642781477`*^9}, {3.7668432020485735`*^9, 
  3.7668432221504908`*^9}, {3.767360280922468*^9, 3.7673603229207735`*^9}, {
  3.767360456474064*^9, 3.767360505896178*^9}, {3.7676474681235685`*^9, 
  3.7676475393408766`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]ij", "[", 
    RowBox[{"\[Epsilon]i_", ",", "\[Epsilon]j_", ",", "kij_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"\[Epsilon]i", " ", "\[Epsilon]j"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "kij"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]ij", "[", 
    RowBox[{"\[Sigma]i_", ",", "\[Sigma]j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Sigma]i", "+", "\[Sigma]j"}], ")"}], "/", "2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.767647838912354*^9, 3.7676478717031813`*^9}, {
  3.767648000032666*^9, 3.767648016246517*^9}, {3.767648307166321*^9, 
  3.7676483085139723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]fDisp", "[", 
   RowBox[{
   "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
    ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5_", ",", "Nbar_",
     ",", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], " ", 
     RowBox[{"\[Rho]CO2", "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"J1", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", "\[Beta]", " ", "\[Epsilon]CO2"}], " ", 
       "+", " ", 
       RowBox[{
        RowBox[{"Nbar", " ", "/", 
         RowBox[{"M", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}]}], " ", 
        RowBox[{"J2", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Beta]", " ", "\[Epsilon]CO2"}], ")"}], "^", "2"}]}]}], 
      ")"}], " ", 
     RowBox[{"\[Sigma]CO2", "^", "3"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], " ", 
     RowBox[{"\[Rho]C5", "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"J1", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", "\[Beta]", " ", "\[Epsilon]C5"}], " ", 
       "+", " ", 
       RowBox[{
        RowBox[{"Nbar", " ", "/", 
         RowBox[{"M", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}]}], " ", 
        RowBox[{"J2", "[", 
         RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
           "]"}], ",", 
          RowBox[{"d", "[", 
           RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}],
           ",", "Nbar"}], "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Beta]", " ", "\[Epsilon]C5"}], ")"}], "^", "2"}]}]}], 
      ")"}], " ", 
     RowBox[{"\[Sigma]C5", "^", "3"}]}], ")"}], "+", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], " ", "\[Rho]CO2", " ", "\[Rho]C5", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"J1", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}], " ", "\[Beta]", " ", 
         RowBox[{"\[Epsilon]ij", "[", 
          RowBox[{"\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5"}], 
          "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Nbar", " ", "/", 
          RowBox[{"M", "[", 
           RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
            RowBox[{"d", "[", 
             RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
             "]"}], ",", 
            RowBox[{"d", "[", 
             RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
             "]"}], ",", "Nbar"}], "]"}]}], " ", 
         RowBox[{"J2", "[", 
          RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], 
            "]"}], ",", 
           RowBox[{"d", "[", 
            RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], 
            "]"}], ",", "Nbar"}], "]"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Beta]", " ", 
            RowBox[{"\[Epsilon]ij", "[", 
             RowBox[{"\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5"}], 
             "]"}]}], ")"}], "^", "2"}]}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Sigma]ij", "[", 
         RowBox[{"\[Sigma]CO2", ",", "\[Sigma]C5"}], "]"}], ")"}], "^", 
       "3"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.766842721977187*^9, 3.766842734394769*^9}, {
  3.766843036334453*^9, 3.766843040136225*^9}, {3.767374924454935*^9, 
  3.7673749320444775`*^9}, {3.7676475518473473`*^9, 3.7676478362487435`*^9}, {
  3.767647880027646*^9, 3.7676478954882793`*^9}, {3.7676479770440016`*^9, 
  3.7676479971910334`*^9}, {3.767648034651396*^9, 3.767648046259884*^9}, {
  3.7680928784612904`*^9, 3.768092879005153*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total Free Energy", "Subsection",
 CellChangeTimes->{{3.7664391165434985`*^9, 3.7664391199245777`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Nbar", "[", 
    RowBox[{"\[Rho]CO2_", ",", "\[Rho]C5_", ",", "NCO2_", ",", "NC5_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NCO2", " ", "\[Rho]CO2"}], " ", "+", 
      RowBox[{"NC5", " ", "\[Rho]C5"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Rho]CO2", "+", "\[Rho]C5"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kij", "[", 
     RowBox[{"ka_", ",", "kb_", ",", "\[Beta]_"}], "]"}], ":=", 
    RowBox[{"ka", " ", "+", " ", 
     RowBox[{"kb", "/", "\[Beta]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "careful", " ", "with", " ", "the", " ", "Boltzmann", " ", "constant", 
     " ", 
     RowBox[{"here", "!"}], " ", "kb", " ", "looks", " ", "like", " ", 
     RowBox[{"kB", ".", " ", "Also"}]}], ",", " ", 
    RowBox[{
     RowBox[{"kb", " ", "is", " ", "given", " ", "in", " ", 
      RowBox[{"Huikuan", "'"}], "s", " ", "slides", " ", "in", " ", "terms", 
      " ", "of", " ", "\[Beta]", " ", "with", " ", "kB"}], " ", "=", " ", 
     "1."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76764808347503*^9, 3.7676481448206277`*^9}, {
  3.767648310804928*^9, 3.767648335251751*^9}, {3.768052849261281*^9, 
  3.7680528816370907`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]f", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Beta]fIG", "[", 
     RowBox[{"\[Rho]CO2", ",", "NCO2"}], "]"}], "+", 
    RowBox[{"\[Beta]fIG", "[", 
     RowBox[{"\[Rho]C5", ",", "NC5"}], "]"}], "+", 
    RowBox[{"\[Beta]fHS", "[", 
     RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], "]"}], 
      ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}]}], 
     "]"}], "+", 
    RowBox[{"\[Beta]fAssoc", "[", 
     RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]CO2", ",", "\[Beta]", ",", "\[Epsilon]CO2"}], "]"}], 
      ",", 
      RowBox[{"d", "[", 
       RowBox[{"\[Sigma]C5", ",", "\[Beta]", ",", "\[Epsilon]C5"}], "]"}], 
      ",", "NCO2", ",", "NC5"}], "]"}], "+", 
    RowBox[{"\[Beta]fDisp", "[", 
     RowBox[{
     "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", ",",
       "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
      RowBox[{"kij", "[", 
       RowBox[{"kCO2C5a", ",", "kCO2C5b", ",", "\[Beta]"}], "]"}], ",", 
      RowBox[{"Nbar", "[", 
       RowBox[{"\[Rho]CO2", ",", "\[Rho]C5", ",", "NCO2", ",", "NC5"}], "]"}],
       ",", "\[Beta]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.766439121586608*^9, 3.7664391818260727`*^9}, {
   3.7667608794334183`*^9, 3.7667608797155128`*^9}, {3.766760944405161*^9, 
   3.7667609445744133`*^9}, {3.766761084729862*^9, 3.76676112874378*^9}, {
   3.7667611775401335`*^9, 3.7667611802824593`*^9}, {3.7667613419661603`*^9, 
   3.7667613421134043`*^9}, {3.766762115229057*^9, 3.766762118740593*^9}, {
   3.766762161555049*^9, 3.7667621874479475`*^9}, {3.76683866472351*^9, 
   3.766838733559309*^9}, {3.766840000442275*^9, 3.7668400052743864`*^9}, {
   3.7668432395832357`*^9, 3.7668432488361473`*^9}, 3.7668432821412945`*^9, {
   3.767375225112522*^9, 3.767375225261249*^9}, {3.767456709983477*^9, 
   3.7674567803852024`*^9}, {3.7674568413798256`*^9, 
   3.7674568565273237`*^9}, {3.7676468044953814`*^9, 
   3.7676468125346613`*^9}, {3.7676480626766253`*^9, 
   3.7676480743330355`*^9}, {3.7676481586257334`*^9, 
   3.7676482287378445`*^9}, {3.767648290737876*^9, 3.7676482987439637`*^9}, {
   3.767648343777483*^9, 3.7676483699702845`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chemical potential", "Subsection",
 CellChangeTimes->{{3.7664392169199877`*^9, 3.766439222786623*^9}, {
   3.7664394123047304`*^9, 3.766439424689309*^9}, 3.7664572709226704`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Mu]CO2", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]f", "[", 
       RowBox[{
       "\[Rho]CO2prime", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], ",", "\[Rho]CO2prime"}], "]"}], "/.", 
    RowBox[{"\[Rho]CO2prime", "\[Rule]", "\[Rho]CO2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Mu]C5", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[Beta]f", "[", 
       RowBox[{
       "\[Rho]CO2", ",", "\[Rho]C5prime", ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], ",", "\[Rho]C5prime"}], "]"}], "/.", 
    RowBox[{"\[Rho]C5prime", "\[Rule]", "\[Rho]C5"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667606020409293`*^9, 3.7667606640878563`*^9}, {
  3.7667607091182785`*^9, 3.766760714617767*^9}, {3.7676483855108457`*^9, 
  3.7676484424766307`*^9}, {3.767648525710697*^9, 3.76764854345258*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pressure", "Subsection",
 CellChangeTimes->{{3.7664394281193423`*^9, 3.766439446366357*^9}, {
  3.7664570995752974`*^9, 3.7664571002089205`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]p", "[", 
    RowBox[{
    "\[Rho]CO2_", ",", "\[Rho]C5_", ",", "\[Sigma]CO2_", ",", "\[Sigma]C5_", 
     ",", "\[Epsilon]CO2_", ",", "\[Epsilon]C5_", ",", "kCO2C5a_", ",", 
     "kCO2C5b_", ",", "NCO2_", ",", "NC5_", ",", "\[Beta]_"}], "]"}], ":=", 
   " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Beta]f", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", 
       ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", 
       "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], "+", 
    RowBox[{"\[Rho]CO2", " ", 
     RowBox[{"\[Beta]\[Mu]CO2", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", 
       ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", 
       "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], "+", 
    RowBox[{"\[Rho]C5", " ", 
     RowBox[{"\[Beta]\[Mu]C5", "[", 
      RowBox[{
      "\[Rho]CO2", ",", "\[Rho]C5", ",", "\[Sigma]CO2", ",", "\[Sigma]C5", 
       ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", 
       "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76645711433683*^9, 3.766457147062825*^9}, {
  3.766457504081125*^9, 3.766457557203376*^9}, {3.7664583213730125`*^9, 
  3.7664583409633703`*^9}, {3.766458746680251*^9, 3.766458767119524*^9}, {
  3.7664588906435037`*^9, 3.766458892519684*^9}, {3.767648450928343*^9, 
  3.7676484983911085`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Parameters", "Section",
 CellChangeTimes->{{3.766457570078002*^9, 3.766457575486906*^9}, {
  3.7680626872169123`*^9, 3.768062688670498*^9}}],

Cell["\<\
Nondimensionalize length by \[Sigma]CO2, the size of a carbon dioxide bead \
(2.79 A). Parameters were obtained from \
20180426_Huikuan_summary_ternary_syst.ppt\
\>", "Text",
 CellChangeTimes->{{3.7677516152418175`*^9, 3.767751640844433*^9}, {
  3.7677518752645917`*^9, 3.767751890690878*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kB", "=", "1.38065*^-23"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Boltzmann", " ", 
    RowBox[{"constant", " ", "[", 
     RowBox[{"J", "/", "K"}], "]"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", "291"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"temperature", " ", "[", "K", "]"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", "=", 
    RowBox[{"1", "/", "T"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"beta", " ", "parameter"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NCO2", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "number", " ", "of", " ", "beads", " ", "used", " ", "to", " ", "model", 
    " ", "CO2"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]CO2", "=", "170.5"}], " ", ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"attractive", " ", "well", " ", "depth"}], ",", " ", 
    RowBox[{"from", " ", "Xu", " ", "et", " ", 
     RowBox[{"al", ".", " ", "2012"}], " ", 
     RowBox[{"JCP", " ", "[", "K", "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]CO2", "=", " ", "2.79*^-10"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"bead", " ", 
    RowBox[{"size", " ", "[", "m", "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]CO2Ref", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "use", " ", "bead", " ", "size", " ", "as", " ", "reference", " ", 
    "length", " ", "for", " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NC5", " ", "=", " ", "2"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "number", " ", "of", " ", "beads", " ", "used", " ", "to", " ", "model", 
    " ", "C5H10"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]C5", "=", "3.92*^-10"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"bead", " ", "size", " ", "of", " ", 
    RowBox[{"cyclopentane", " ", "[", "m", "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]C5Ref", " ", "=", " ", 
   RowBox[{"\[Sigma]C5", "/", "\[Sigma]CO2"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "nondimensionalized", " ", "bead", " ", "size", " ", "of", " ", 
    "cyclopentane"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Epsilon]C5", "=", "289.82"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "attractive", " ", "well", " ", "depth", " ", "of", " ", "cyclopentane"}],
     ",", " ", 
    RowBox[{"from", " ", "Xu", " ", "et", " ", 
     RowBox[{"al", ".", " ", "2012"}], " ", 
     RowBox[{"JCP", " ", "[", "K", "]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"kCO2C5a", "=", "0.125"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "constant", " ", "parameter", " ", "for", " ", "temperature", " ", 
    "dependence", " ", "of", " ", 
    RowBox[{"interaction", " ", "[", "J", "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"kCO2C5b", "=", 
   RowBox[{"-", "2.903*^-6"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "coefficient", " ", "of", " ", "temperature", " ", "for", " ", 
    "temperature", " ", "dependence", " ", "of", " ", 
    RowBox[{"interaction", " ", "[", 
     RowBox[{"J", "/", "K"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MBeadCO2", "=", " ", 
   RowBox[{"0.044", "/", "NCO2"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "molar", " ", "mass", " ", "of", " ", "one", " ", "bead", " ", "of", " ", 
    "carbon", " ", 
    RowBox[{"dioxide", " ", "[", 
     RowBox[{"kg", "/", "mol"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MBeadC5", "=", " ", 
   RowBox[{"0.071", "/", "NC5"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "molar", " ", "mass", " ", "of", " ", "one", " ", "bead", " ", "of", " ", 
    RowBox[{"cyclopentane", " ", "[", 
     RowBox[{"kg", "/", "mol"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NA", " ", "=", " ", "6.022*^23"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Avogadro", "'"}], "s", " ", 
    RowBox[{"number", " ", "[", 
     RowBox[{"molecules", "/", "mol"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Rho]CO2Conv", "=", 
   RowBox[{
    RowBox[{"\[Sigma]CO2", "^", "3"}], "*", 
    RowBox[{"NA", "/", "MBeadCO2"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convert", " ", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"molecules", "/", 
     RowBox[{"\[Sigma]CO2", "^", "3"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Rho]C5Conv", "=", 
   RowBox[{
    RowBox[{"\[Sigma]CO2", "^", "3"}], "*", 
    RowBox[{"NA", "/", "MBeadC5"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convert", " ", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"molecules", "/", 
     RowBox[{"\[Sigma]CO2", "^", "3"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Pa2MPa", " ", "=", " ", "1*^-6"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"multiplicative", " ", "conversion", " ", "from", " ", "Pa"}], 
    " ", "\[Rule]", " ", "MPa"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"pConv", " ", "=", " ", 
   RowBox[{"Pa2MPa", "*", "kB", "*", "T", "*", 
    RowBox[{"\[Sigma]CO2", "^", 
     RowBox[{"(", 
      RowBox[{"-", "3"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7664591936153975`*^9, 3.766459248347232*^9}, 
   3.766624476976756*^9, {3.76662720945208*^9, 3.7666273494900618`*^9}, {
   3.7666273859603004`*^9, 3.7666273974370823`*^9}, {3.766627452208065*^9, 
   3.7666275948992662`*^9}, {3.76662786647266*^9, 3.7666278834680777`*^9}, {
   3.76676073771898*^9, 3.766760780433696*^9}, {3.766761024018258*^9, 
   3.7667610248958206`*^9}, {3.7667612138696575`*^9, 3.76676132635797*^9}, {
   3.766762070305524*^9, 3.7667620929160414`*^9}, {3.7667621312693715`*^9, 
   3.766762151021905*^9}, {3.766768111232124*^9, 3.7667682752769012`*^9}, {
   3.766768323142599*^9, 3.766768323392592*^9}, {3.7667685026193175`*^9, 
   3.7667685038571196`*^9}, {3.7667687821597385`*^9, 
   3.7667687827561903`*^9}, {3.7667688690894623`*^9, 3.766768886711793*^9}, {
   3.766768966321562*^9, 3.7667689763525505`*^9}, {3.7667690504873285`*^9, 
   3.7667690520154223`*^9}, {3.766841236834464*^9, 3.766841298106201*^9}, {
   3.766841414759708*^9, 3.766841415156062*^9}, {3.7668416585292587`*^9, 
   3.7668416670358143`*^9}, {3.7668417299185967`*^9, 
   3.7668417830632424`*^9}, {3.7668418836475887`*^9, 3.766841940273589*^9}, {
   3.766842039604266*^9, 3.766842040470434*^9}, {3.7668425644026303`*^9, 
   3.766842585199622*^9}, {3.7668437565206966`*^9, 3.7668437643884916`*^9}, {
   3.7670130880822973`*^9, 3.767013105478735*^9}, {3.7670251893747478`*^9, 
   3.767025189755666*^9}, {3.767364297945385*^9, 3.7673643229792128`*^9}, {
   3.767366451076212*^9, 3.7673664936360264`*^9}, {3.7673665372417355`*^9, 
   3.7673665387229147`*^9}, {3.7673750435401344`*^9, 
   3.7673750706586685`*^9}, {3.767375368952506*^9, 3.7673754393884172`*^9}, {
   3.7673754985795546`*^9, 3.7673755235951304`*^9}, {3.7673755815413866`*^9, 
   3.7673755876932287`*^9}, {3.7673756378214974`*^9, 
   3.7673757111780515`*^9}, {3.7673757942251964`*^9, 
   3.7673758366324706`*^9}, {3.767376326198023*^9, 3.7673763732391396`*^9}, {
   3.7674071044645166`*^9, 3.767407148463358*^9}, {3.7674558230630198`*^9, 
   3.7674558407096605`*^9}, {3.767456091739439*^9, 3.767456091850152*^9}, {
   3.7677509616751127`*^9, 3.7677509719615183`*^9}, {3.7677510459710927`*^9, 
   3.7677511989925623`*^9}, {3.767751357542054*^9, 3.7677514173539195`*^9}, {
   3.767751453756855*^9, 3.7677514544287734`*^9}, {3.7677515848002143`*^9, 
   3.7677516020257254`*^9}, {3.767751701722649*^9, 3.7677517518992023`*^9}, {
   3.767751789521467*^9, 3.7677517983515697`*^9}, {3.767751869895677*^9, 
   3.7677518700476413`*^9}, {3.7680925028156724`*^9, 
   3.7680925111349125`*^9}, {3.7680926892075706`*^9, 3.768092820485426*^9}, {
   3.768152351499567*^9, 3.768152364301265*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Solving for density by setting chemical potentials equal", "Section",
 CellChangeTimes->{{3.7680527032402472`*^9, 3.768052713186412*^9}, {
  3.768052921318932*^9, 3.7680529217110214`*^9}}],

Cell["\<\
Test method for solving for coexistence densities and mole fractions.\
\>", "Text",
 CellChangeTimes->{{3.768095062109434*^9, 3.7680950740127444`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"set", " ", "the", " ", 
    RowBox[{"pressure", " ", "[", "MPa", "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]V0", "=", "100"}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"guess", " ", "for", " ", "density", " ", "of", " ", "vapor", " ", 
    RowBox[{"phase", " ", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Rho]L0", "=", "1000"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"guess", " ", "for", " ", "density", " ", "of", " ", "liquid", " ", 
    RowBox[{"phase", " ", "[", 
     RowBox[{"kg", "/", 
      RowBox[{"m", "^", "3"}]}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"xCO20", "=", "0.1"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "guess", " ", "for", " ", "mole", " ", "fraction", " ", "of", " ", "CO2", 
    " ", "in", " ", "liquid", " ", "phase"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"yCO20", "=", "0.94"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "guess", " ", "for", " ", "mole", " ", "fraction", " ", "of", " ", "CO2", 
    " ", "in", " ", "vapor", " ", "phase"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7680598270516653`*^9, 3.768059834605973*^9}, {
   3.7680629761793957`*^9, 3.76806297948508*^9}, {3.768091302024472*^9, 
   3.768091338452476*^9}, {3.768092289283366*^9, 3.7680923076911745`*^9}, {
   3.768092455005172*^9, 3.768092473960995*^9}, {3.768092525934538*^9, 
   3.7680925288816714`*^9}, {3.7680926457185316`*^9, 
   3.7680926802778955`*^9}, {3.7680928163779297`*^9, 3.7680928294102*^9}, {
   3.7680929115153055`*^9, 3.7680929404289794`*^9}, {3.7681522695362377`*^9, 
   3.768152290258478*^9}, 3.76815289049724*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]\[Mu]CO2", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
         RowBox[{"\[Beta]\[Mu]CO2", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Beta]\[Mu]C5", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
         RowBox[{"\[Beta]\[Mu]C5", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Beta]p", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "==", 
         RowBox[{"\[Beta]p", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]V", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}], "pConv"}], "\[Equal]", "p"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Rho]V", ",", "\[Rho]V0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Rho]L", ",", "\[Rho]L0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xCO2", ",", "xCO20"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"yCO2", ",", "yCO20"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.7680529466948137`*^9, 3.7680530027540054`*^9}, {
   3.7680530374127455`*^9, 3.7680531583481045`*^9}, {3.7680597464749117`*^9, 
   3.7680597975572047`*^9}, {3.7680598366390114`*^9, 
   3.7680598372014604`*^9}, {3.768062099126865*^9, 3.7680620998554325`*^9}, {
   3.7680912221837883`*^9, 3.76809129115659*^9}, {3.76809221968834*^9, 
   3.768092283818981*^9}, {3.768092353480116*^9, 3.768092385465342*^9}, 
   3.7680924479641943`*^9, {3.7680925720406847`*^9, 3.7680926194732094`*^9}, {
   3.768093008432645*^9, 3.768093086936783*^9}, {3.7680948098321753`*^9, 
   3.7680948298663025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["result"], "Input",
 CellChangeTimes->{{3.768093043065653*^9, 3.768093043596901*^9}, {
  3.7680947877019157`*^9, 3.7680948191071863`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Rho]V", "\[Rule]", 
    RowBox[{"19.81303380751613`", "\[VeryThinSpace]", "+", 
     RowBox[{"2.7073706267185125`*^-27", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"\[Rho]L", "\[Rule]", 
    RowBox[{"777.7293466811531`", "\[VeryThinSpace]", "-", 
     RowBox[{"5.363749284523539`*^-25", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"xCO2", "\[Rule]", 
    RowBox[{"0.08469889060697933`", "\[VeryThinSpace]", "-", 
     RowBox[{"3.3826355615876986`*^-27", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"yCO2", "\[Rule]", 
    RowBox[{"0.9354637204459028`", "\[VeryThinSpace]", "-", 
     RowBox[{"2.7136815139602806`*^-28", " ", "\[ImaginaryI]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.768093049314249*^9, {3.7680947930156116`*^9, 3.768094819490884*^9}, 
   3.7680955283236237`*^9, {3.768096003072407*^9, 3.768096016903197*^9}, 
   3.76814485535215*^9, {3.768152065361172*^9, 3.7681520888037863`*^9}, {
   3.768152240945253*^9, 3.768152246011076*^9}, {3.7681522771835604`*^9, 
   3.7681522921490474`*^9}, 3.768152900786641*^9, 3.7681530783043156`*^9, 
   3.768153292637497*^9, 3.768153660040785*^9, {3.768153690577823*^9, 
   3.7681537513952303`*^9}, 3.768153785769975*^9, 3.768153897107839*^9, 
   3.768153957025782*^9, 3.7681554894094744`*^9}]
}, Open  ]],

Cell["\<\
Now try solving for several coexistence compositions and storing the results \
in lists.\
\>", "Text",
 CellChangeTimes->{{3.7680950833892517`*^9, 3.7680950994433546`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pList", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.1", ",", "6.1", ",", "1.5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]VList", "=", "pList"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]LList", "=", "pList"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xCO2List", "=", "pList"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yCO2List", "=", "pList"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7680951170297103`*^9, 3.7680951859003553`*^9}, {
  3.768095377791018*^9, 3.768095377978505*^9}, {3.7680965783640604`*^9, 
  3.7680965846378593`*^9}, {3.768097247451535*^9, 3.7680972567215786`*^9}, {
  3.7680973518582497`*^9, 3.768097366096775*^9}, {3.7680974249398775`*^9, 
  3.7680974266687813`*^9}, {3.768097571543656*^9, 3.768097575669261*^9}, {
  3.768144819638036*^9, 3.7681448480437055`*^9}, {3.7681523743242674`*^9, 
  3.7681523763856325`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "pList", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"pList", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"result", " ", "=", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]\[Mu]CO2", "[", 
           RowBox[{
            RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]L", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
          RowBox[{"\[Beta]\[Mu]CO2", "[", 
           RowBox[{
            RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]V", 
             RowBox[{"(", 
              RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Beta]\[Mu]C5", "[", 
           RowBox[{
            RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]L", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
          RowBox[{"\[Beta]\[Mu]C5", "[", 
           RowBox[{
            RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]V", 
             RowBox[{"(", 
              RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]L", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}], "==", 
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]V", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]p", "[", 
            RowBox[{
             RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
             RowBox[{"\[Rho]V", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
             "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
             ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2",
              ",", "NC5", ",", "\[Beta]"}], "]"}], "pConv"}], "\[Equal]", 
          "p"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Rho]V", ",", "\[Rho]V0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]L", ",", "\[Rho]L0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xCO2", ",", "xCO20"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"yCO2", ",", "yCO20"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Rho]VList", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"\[Rho]V", "/.", "result"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Rho]LList", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"\[Rho]L", "/.", "result"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xCO2List", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"xCO2", "/.", "result"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"yCO2List", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"yCO2", "/.", "result"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "i", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7680951903427315`*^9, 3.7680953681834345`*^9}, {
   3.768095430367792*^9, 3.7680954978993983`*^9}, {3.7680955533397245`*^9, 
   3.7680955536522202`*^9}, {3.768095596405162*^9, 3.768095624684109*^9}, 
   3.7680956845424805`*^9, 3.7680957214437838`*^9, {3.768095754304832*^9, 
   3.7680957556800337`*^9}, {3.7680957987796936`*^9, 
   3.7680958475456743`*^9}, {3.7680958822399597`*^9, 3.7680959365437403`*^9}, 
   3.76809604954755*^9, {3.7680966056131096`*^9, 3.7680966124059095`*^9}, {
   3.768096657277248*^9, 3.7680966790578146`*^9}, {3.7680967468551793`*^9, 
   3.768096751666844*^9}, {3.7680967958625755`*^9, 3.76809679706553*^9}, {
   3.768096858661125*^9, 3.7680968680773845`*^9}, {3.7680969430912533`*^9, 
   3.768097044676445*^9}, {3.768097111110301*^9, 3.768097170566866*^9}, 
   3.768097229981876*^9, {3.768097264621485*^9, 3.7680972719243207`*^9}, {
   3.7680973077293158`*^9, 3.7680973420181007`*^9}, {3.7680973839186645`*^9, 
   3.768097389457303*^9}, {3.7680974475281057`*^9, 3.7680974633822017`*^9}, 
   3.768097591074832*^9}],

Cell[CellGroupData[{

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.7681543790970273`*^9, 3.7681554970714865`*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.7681543790970273`*^9, 3.768155504427045*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{3.7681543790970273`*^9, 3.7681555114200554`*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{3.7681543790970273`*^9, 3.768155518721988*^9}],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{3.7681543790970273`*^9, 3.7681555269203024`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot", "Section",
 CellChangeTimes->{{3.7681540154279146`*^9, 3.768154016349318*^9}}],

Cell["\<\
Convert data into desired format: {{x1,y1},{x2,y2},...}\
\>", "Text",
 CellChangeTimes->{{3.7681542951990943`*^9, 3.7681543084542522`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"liquidData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"xCO2List", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"pList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vaporData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"yCO2List", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"pList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.768154311749117*^9, 3.7681543495515385`*^9}, {
  3.768154439780921*^9, 3.7681544837372847`*^9}, {3.7681545920772285`*^9, 
  3.7681545964537086`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{"vaporData", ",", "liquidData"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7681540233731213`*^9, 3.768154042027195*^9}, {
  3.7681541083781223`*^9, 3.7681541087948837`*^9}, {3.7681541551838703`*^9, 
  3.7681541895580425`*^9}, {3.768154223937232*^9, 3.7681542254510484`*^9}, {
  3.768154260932721*^9, 3.7681542857686167`*^9}, {3.768154394300062*^9, 
  3.7681543951877832`*^9}, {3.7681544897888603`*^9, 3.7681545852851505`*^9}, {
  3.7681546547562246`*^9, 3.7681546696835623`*^9}, {3.768154767762652*^9, 
  3.768154769810607*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{0.503677871310562, 0.1}, {0.9571787764144194, 1.6}, {
     0.9747963328194075, 3.1}, {0.9823817288918354, 4.6}, {1.008091099858058, 
     6.1}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    PointBox[{{0.005216664591568513, 0.1}, {0.1434079551533875, 1.6}, {
     0.32689704417739873`, 3.1}, {0.6779650027574333, 4.6}, {
     1.0364997148149722`, 6.1}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{0., 1.0364997148149722`}, {0., 6.1}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{
  3.7681539620122323`*^9, {3.768154162000552*^9, 3.7681542271332397`*^9}, {
   3.768154272596279*^9, 3.7681542864128485`*^9}, {3.7681544477794647`*^9, 
   3.768154498167036*^9}, 3.768154536948533*^9, 3.7681545994692435`*^9, 
   3.768154658504546*^9, 3.768155527196813*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Data", "Section",
 CellChangeTimes->{{3.768154977285226*^9, 3.768154981297043*^9}}],

Cell["\<\
...for better plotting elsewhere.\
\>", "Text",
 CellChangeTimes->{{3.7681549829020853`*^9, 3.768154987243471*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TList", "=", 
   RowBox[{"{", 
    RowBox[{"291", ",", "301"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pList", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.1", ",", "9", ",", "0.5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2Save", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2Save", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xCO22Save", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yCO22Save", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"count", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imThresh", "=", "0.001"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "threshold", " ", "of", " ", "imaginary", " ", "component", " ", "above", 
    " ", "which", " ", "value", " ", "is", " ", "ignored"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.768155182618605*^9, 3.7681552254816213`*^9}, {
  3.768155305997158*^9, 3.768155411968639*^9}, {3.7681555368700886`*^9, 
  3.768155539586008*^9}, {3.768155646094104*^9, 3.7681556483426905`*^9}, {
  3.7681563198253655`*^9, 3.7681563213055468`*^9}, {3.768156711771515*^9, 
  3.768156723392789*^9}, {3.7681567679299498`*^9, 3.768156782378807*^9}, {
  3.768156853343977*^9, 3.768156865480263*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "TList", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"TList", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Beta]", "=", 
     RowBox[{"1", "/", "T"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pConv", " ", "=", " ", 
     RowBox[{"Pa2MPa", "*", "kB", "*", "T", "*", 
      RowBox[{"\[Sigma]CO2", "^", 
       RowBox[{"(", 
        RowBox[{"-", "3"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "pList", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"pList", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Beta]\[Mu]CO2", "[", 
              RowBox[{
               RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
               RowBox[{"\[Rho]L", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
               ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
               "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
             RowBox[{"\[Beta]\[Mu]CO2", "[", 
              RowBox[{
               RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
               RowBox[{"\[Rho]V", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
               ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
               "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Beta]\[Mu]C5", "[", 
              RowBox[{
               RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
               RowBox[{"\[Rho]L", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
               ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
               "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
             RowBox[{"\[Beta]\[Mu]C5", "[", 
              RowBox[{
               RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
               RowBox[{"\[Rho]V", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
               ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
               "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"\[Beta]p", "[", 
              RowBox[{
               RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
               RowBox[{"\[Rho]L", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
               ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
               "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}], "==", 
             RowBox[{"\[Beta]p", "[", 
              RowBox[{
               RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
               RowBox[{"\[Rho]V", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
               "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
               ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
               "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Beta]p", "[", 
               RowBox[{
                RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
                RowBox[{"\[Rho]V", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
                "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", 
                ",", "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", 
                "NCO2", ",", "NC5", ",", "\[Beta]"}], "]"}], "pConv"}], 
             "\[Equal]", "p"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Rho]V", ",", "\[Rho]V0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Rho]L", ",", "\[Rho]L0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xCO2", ",", "xCO20"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"yCO2", ",", "yCO20"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xCO2", "=", 
        RowBox[{"xCO2", "/.", "result"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yCO2", "=", 
        RowBox[{"yCO2", "/.", "result"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Re", "[", "xCO2", "]"}], "\[LessEqual]", "1"}], "&&", 
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"Re", "[", "yCO2", "]"}], "\[LessEqual]", "1"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "xCO2", "]"}], "]"}], "<", "imThresh"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "yCO2", "]"}], "]"}], "<", "imThresh"}]}], ",",
          " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "only", " ", "include", " ", "values", " ", "that", " ", "are", " ",
            "physical"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"T2Save", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"T2Save", ",", 
             RowBox[{"{", "T", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p2Save", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"p2Save", ",", 
             RowBox[{"{", "p", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"xCO22Save", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xCO22Save", ",", 
             RowBox[{"{", 
              RowBox[{"Re", "[", "xCO2", "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"yCO22Save", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"yCO22Save", ",", 
             RowBox[{"{", 
              RowBox[{"Re", "[", "yCO2", "]"}], "}"}]}], "]"}]}], ";"}], ",", 
         "Null"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"count", ",", "\"\< of \>\"", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", "TList", "]"}], 
           RowBox[{"Length", "[", "pList", "]"}]}]}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"count", "++"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7681551397225266`*^9, 3.768155177802145*^9}, {
  3.7681552461493173`*^9, 3.768155295747259*^9}, {3.768155369260233*^9, 
  3.768155450351369*^9}, {3.7681555051834483`*^9, 3.7681555103263807`*^9}, {
  3.7681562075901513`*^9, 3.7681562235051155`*^9}, {3.76815632323221*^9, 
  3.7681563366333103`*^9}, {3.768156376073991*^9, 3.768156490212886*^9}, {
  3.7681565834427395`*^9, 3.768156640077985*^9}, {3.768156697787081*^9, 
  3.7681566997822523`*^9}, {3.7681567588868217`*^9, 3.768156763308931*^9}, {
  3.768156809273277*^9, 3.768156829377282*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0.005216664591568513`", "\[VeryThinSpace]", "-", 
  RowBox[{"1.410656698558747`*^-15", " ", "\[ImaginaryI]"}]}]], "Print",
 CellChangeTimes->{3.7681563516872644`*^9, 3.7681567337442226`*^9, 
  3.7681567908215885`*^9}],

Cell[BoxData[
 RowBox[{"0.503677871310562`", "\[VeryThinSpace]", "-", 
  RowBox[{"9.283259872452304`*^-16", " ", "\[ImaginaryI]"}]}]], "Print",
 CellChangeTimes->{3.7681563516872644`*^9, 3.7681567337442226`*^9, 
  3.7681567908372107`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1", "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm[1, " of ", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.7681563516872644`*^9, 3.7681567337442226`*^9, 
  3.7681567908372107`*^9}],

Cell[BoxData["0.1434079551533875`"], "Print",
 CellChangeTimes->{3.7681563516872644`*^9, 3.7681567337442226`*^9, 
  3.768156797564492*^9}],

Cell[BoxData["0.9571787764144194`"], "Print",
 CellChangeTimes->{3.7681563516872644`*^9, 3.7681567337442226`*^9, 
  3.768156797572489*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "2", "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm[2, " of ", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.7681563516872644`*^9, 3.7681567337442226`*^9, 
  3.7681567975794835`*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.768156342113494*^9, 3.7681563645912857`*^9}, 
   3.7681567428292465`*^9, 3.768156801444276*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["T2Save"], "Input",
 CellChangeTimes->{{3.768156744034436*^9, 3.7681567449059668`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"291", ",", "291"}], "}"}]], "Output",
 CellChangeTimes->{3.768156745171574*^9, 3.7681568029031935`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["xCO2"], "Input",
 CellChangeTimes->{{3.7681567478847456`*^9, 3.768156748481299*^9}}],

Cell[BoxData["0.1434079551533875`"], "Output",
 CellChangeTimes->{3.768156748940037*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["xCO22Save"], "Input",
 CellChangeTimes->{{3.7681567524126015`*^9, 3.76815675434067*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7681567546346316`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<T [K]\>\"", ",", "\"\<p [MPa]\>\"", ",", "\"\<xCO2\>\"", ",", 
     "\"\<yCO2\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataTable", "=", 
   RowBox[{"Prepend", " ", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"T2Save", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"p2Save", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"xCO22Save", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"yCO22Save", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "T2Save", "]"}]}], "}"}]}], "]"}], ",", 
     "header"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "\"\<co2_c5h10_eos_pred.csv\>\""}], "}"}], 
     "]"}], ",", "dataTable", ",", "\"\<CSV\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7681549884465137`*^9, 3.7681549890693207`*^9}, {
  3.768155025711422*^9, 3.768155086079226*^9}, {3.76815513494908*^9, 
  3.7681551354177966`*^9}, {3.768155456295035*^9, 3.768155465849293*^9}, {
  3.768155806730596*^9, 3.768155864406955*^9}, {3.7681559499889593`*^9, 
  3.7681559733612022`*^9}, {3.7681560044481792`*^9, 3.7681561377754126`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "xCO2List"}]], "Input",
 CellChangeTimes->{{3.768144872102522*^9, 3.768144873212801*^9}, {
  3.768152391226367*^9, 3.768152391491976*^9}, {3.768152813893225*^9, 
  3.768152816989312*^9}, {3.768155090113967*^9, 3.7681550910329475`*^9}, {
  3.7681559004077897`*^9, 3.7681559212857513`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "291", ",", "0.1`", ",", "0.005216664591568513`", ",", 
     "0.503677871310562`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "291", ",", "1.6`", ",", "0.1434079551533875`", ",", 
     "0.9571787764144194`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "291", ",", "3.1`", ",", "0.32689704417739873`", ",", 
     "0.9747963328194075`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "291", ",", "4.6`", ",", "0.6779650027574333`", ",", 
     "0.9823817288918354`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "291", ",", "6.1`", ",", "1.0364997148149722`", ",", 
     "1.008091099858058`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "301", ",", "0.1`", ",", "0.003268216153740916`", ",", 
     "0.3318520377931541`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "301", ",", "1.6`", ",", "0.12044789352737827`", ",", 
     "0.937391011271842`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "301", ",", "3.1`", ",", "0.26219103991354087`", ",", 
     "0.9624831034939679`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "301", ",", "4.6`", ",", "0.4624801995230451`", ",", 
     "0.9708450779391049`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "301", ",", "6.1`", ",", "0.8222190429316028`", ",", 
     "0.978378588602683`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7681448735508623`*^9, 3.768152066571733*^9, {3.768152383450638*^9, 
   3.768152392192691*^9}, 3.768152823417143*^9, 3.7681531122575874`*^9, 
   3.7681532952518272`*^9, {3.768153692915845*^9, 3.7681537531100473`*^9}, 
   3.768153899374979*^9, 3.76815552784352*^9, 3.7681559010658264`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.005216664591568513`", "\[VeryThinSpace]", "-", 
    RowBox[{"1.410656698558747`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
   "0.1434079551533875`", ",", "0.32689704417739873`", ",", 
   RowBox[{"0.6779650027574333`", "\[VeryThinSpace]", "+", 
    RowBox[{"1.7448227954941055`*^-21", " ", "\[ImaginaryI]"}]}], ",", 
   "1.0364997148149722`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7681448735508623`*^9, 3.768152066571733*^9, {3.768152383450638*^9, 
   3.768152392192691*^9}, 3.768152823417143*^9, 3.7681531122575874`*^9, 
   3.7681532952518272`*^9, {3.768153692915845*^9, 3.7681537531100473`*^9}, 
   3.768153899374979*^9, 3.76815552784352*^9, 3.7681559010658264`*^9}]
}, Open  ]],

Cell["\<\
For some reason this is not returning real numbers and I cannot restrict the \
search of FindRoot to real numbers. Instead, I will try FindInstance. Of \
course, now I cannot supply an initial guess and the solution is VERY SLOW \
(never waited long enough for this to converge).\
\>", "Text",
 CellChangeTimes->{{3.768145136110055*^9, 3.7681451639246273`*^9}, {
  3.7681453158173904`*^9, 3.7681453227525787`*^9}, {3.7681531360680695`*^9, 
  3.7681531514577265`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", 
    RowBox[{"FindInstance", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]\[Mu]CO2", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
         RowBox[{"\[Beta]\[Mu]CO2", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"\[Beta]\[Mu]C5", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
         RowBox[{"\[Beta]\[Mu]C5", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"\[Beta]p", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "==", 
         RowBox[{"\[Beta]p", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]V", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}], "pConv"}], "\[Equal]", "p"}], "&&", 
        RowBox[{"0", "<", "\[Rho]V"}], " ", "&&", " ", 
        RowBox[{"\[Rho]V", " ", "<", " ", "\[Rho]L"}], " ", "&&", " ", 
        RowBox[{"\[Rho]L", " ", "<", " ", "5000"}], " ", "&&", " ", 
        RowBox[{"0", "<", "xCO2"}], " ", "&&", " ", 
        RowBox[{"xCO2", "<", "yCO2"}], " ", "&&", " ", 
        RowBox[{"yCO2", " ", "<", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]V", ",", "\[Rho]L", ",", "xCO2", ",", "yCO2"}], "}"}], 
      ",", " ", "Reals"}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.7681451685782876`*^9, 3.768145249755891*^9}, {
  3.7681452907111044`*^9, 3.7681452949617243`*^9}, {3.7681524047302446`*^9, 
  3.7681524624260225`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7681528209068003`*^9, 3.768153153855573*^9, 3.7681533049651394`*^9, {
   3.768153695368907*^9, 3.768153754218625*^9}, 3.768153903231162*^9, 
   3.7681541605166283`*^9, 3.7681555482241163`*^9}]
}, Open  ]],

Cell["\<\




Try using NSolve, which allows specification of region but not initial guess. \
VERY SLOW.\
\>", "Text",
 CellChangeTimes->{{3.768093156217269*^9, 3.768093166087102*^9}, {
  3.7680937436448607`*^9, 3.7680937454615965`*^9}, {3.7680974392213044`*^9, 
  3.7680974399934864`*^9}, {3.768144867186551*^9, 3.7681448707468815`*^9}, {
  3.768145123582011*^9, 3.768145133481447*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", 
    RowBox[{"NSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]\[Mu]CO2", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
         RowBox[{"\[Beta]\[Mu]CO2", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Beta]\[Mu]C5", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "\[Equal]", 
         RowBox[{"\[Beta]\[Mu]C5", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"\[Beta]p", "[", 
          RowBox[{
           RowBox[{"\[Rho]L", " ", "xCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]L", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "xCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}], "==", 
         RowBox[{"\[Beta]p", "[", 
          RowBox[{
           RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
           RowBox[{"\[Rho]V", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
           "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",", 
           "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", 
           "NC5", ",", "\[Beta]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]V", " ", "yCO2", " ", "\[Rho]CO2Conv"}], ",", 
            RowBox[{"\[Rho]V", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "yCO2"}], ")"}], "\[Rho]C5Conv"}], ",", 
            "\[Sigma]CO2Ref", ",", "\[Sigma]C5Ref", ",", "\[Epsilon]CO2", ",",
             "\[Epsilon]C5", ",", "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",",
             "NC5", ",", "\[Beta]"}], "]"}], "pConv"}], "\[Equal]", "p"}], 
        ",", 
        RowBox[{"\[Rho]L", ">", "0"}], ",", 
        RowBox[{"\[Rho]L", "<", "2500"}], ",", 
        RowBox[{"\[Rho]V", ">", "0"}], ",", 
        RowBox[{"\[Rho]V", "<", "\[Rho]L"}], ",", 
        RowBox[{"0", "<", "xCO2"}], ",", 
        RowBox[{"xCO2", "<", "yCO2"}], ",", " ", 
        RowBox[{"yCO2", "<", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]V", ",", "\[Rho]L", ",", "xCO2", ",", "yCO2"}], "}"}]}],
      "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.768093169665928*^9, 3.768093274543191*^9}, {
  3.768094724617715*^9, 3.7680947253465405`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7680945944807777`*^9, 3.7681448635079465`*^9, 
  3.768152077600595*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["result"], "Input",
 CellChangeTimes->{{3.768093281471166*^9, 3.768093281808879*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{299., {3., 9.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
              "\[Equal]", 
              RowBox[{
               RowBox[{"\[LeftSkeleton]", "16", "\[RightSkeleton]"}], "+", 
               FractionBox[
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                "\[Pi]"], "-", 
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"Log", "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"0.13146363053443638`", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0.0007184886868747252`", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "yCO2"}], ")"}], " ", "\[Rho]V"}], "+", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    FractionBox["1", "6"], " ", "\[Pi]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0.001003384521965856`", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "yCO2"}], ")"}], " ", "\[Rho]V"}], "+", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    ")"}]}]}], ")"}], "3"]], "+", 
                  FractionBox[
                   RowBox[{"0.7691464993126885`", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    ")"}]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    ")"}], "2"]], "+", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    RowBox[{
                    FractionBox["1", "6"], " ", "\[Pi]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0.001003384521965856`", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "yCO2"}], ")"}], " ", "\[Rho]V"}], "+", 
                    RowBox[{
                    RowBox[{"\[LeftSkeleton]", "22", "\[RightSkeleton]"}], 
                    " ", 
                    RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}], " ",
                     "\[Rho]V"}]}], ")"}]}]}]]}], "]"}]}]}]}], ",", 
             RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], ",", 
             RowBox[{
              RowBox[{"184.99669784547018`", " ", 
               RowBox[{"(", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}]}],
               "\[Equal]", "1"}]}], "}"}], ",", 
           RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{54., {1., 9.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 148, 24694274040859391235, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{60., {1., 9.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 148, 24694274040859391235, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{92., {3., 9.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 148, 24694274040859391235, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{78., {1., 9.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[148]]], "Output",
 CellChangeTimes->{3.7680948031647587`*^9}]
}, Open  ]],

Cell["\<\
Can also try solving using FindInstance, which allows the user to specify a \
domain for the unknown variables\
\>", "Text",
 CellChangeTimes->{{3.76806221745084*^9, 3.7680622349820013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]\[Mu]CO2", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "\[Equal]", 
      RowBox[{"\[Beta]\[Mu]CO2", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]\[Mu]C5", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "\[Equal]", 
      RowBox[{"\[Beta]\[Mu]C5", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]p", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "==", 
      RowBox[{"\[Beta]p", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"0", "<", "\[Rho]", "<", "1"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"0", "<", "xCO2"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"xCO2", "<", "yCO2", "<", "1"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "xCO2", ",", "yCO2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7680622384973464`*^9, 3.7680622410171137`*^9}, {
  3.768062333248869*^9, 3.768062460598013*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.768062967100172*^9}]
}, Open  ]],

Cell["\<\
Set a value for the liquid mole fraction of CO2\
\>", "Text",
 CellChangeTimes->{{3.7680628026614428`*^9, 3.768062808265032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xCO2", " ", "=", " ", "0.1"}], ";"}]], "Input",
 CellChangeTimes->{{3.7680628099034643`*^9, 3.768062812579469*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]\[Mu]CO2", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "\[Equal]", 
      RowBox[{"\[Beta]\[Mu]CO2", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]\[Mu]C5", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "\[Equal]", 
      RowBox[{"\[Beta]\[Mu]C5", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"0", "<", "\[Rho]", "<", "1"}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{"xCO2", "<", "yCO2", "<", "1"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "yCO2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7680628151520877`*^9, 3.7680628449751034`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.768063873632416*^9}]
}, Open  ]],

Cell["\<\
Or try solving with FindRoot, which allows the user to guess an initial \
solution (maybe try to have intelligent guesses based on Huikuan\
\[CloseCurlyQuote]s model?)\
\>", "Text",
 CellChangeTimes->{{3.768062888497203*^9, 3.768062899650955*^9}, {
  3.768062954341671*^9, 3.76806296267472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]0", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yCO20", "=", "0.2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7680629391566*^9, 3.7680629473361235`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]\[Mu]CO2", "[", 
         RowBox[{
          RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
          RowBox[{"\[Rho]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
          "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
          "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", 
          "\[Beta]"}], "]"}], "-", 
        RowBox[{"\[Beta]\[Mu]CO2", "[", 
         RowBox[{
          RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
          RowBox[{"\[Rho]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
          "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
          "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", 
          "\[Beta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Beta]\[Mu]C5", "[", 
         RowBox[{
          RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
          RowBox[{"\[Rho]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
          "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
          "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", 
          "\[Beta]"}], "]"}], "-", 
        RowBox[{"\[Beta]\[Mu]C5", "[", 
         RowBox[{
          RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
          RowBox[{"\[Rho]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
          "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
          "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", 
          "\[Beta]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", " ", "\[Rho]0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"yCO2", ",", "yCO20"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.768062902310032*^9, 3.768062936987037*^9}, {
  3.768063884604307*^9, 3.768063909916814*^9}, {3.7680640179610624`*^9, 
  3.7680640308303313`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(MachinePrecision\\)\[NoBreak] digits of working precision to \
meet these tolerances. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7680640314084063`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["result"], "Input",
 CellChangeTimes->{{3.768063888175047*^9, 3.7680638885448675`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Rho]", "\[Rule]", 
    RowBox[{"42321.0144371755`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.001958450726351856`", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"yCO2", "\[Rule]", 
    RowBox[{"0.07886365883011091`", "\[VeryThinSpace]", "+", 
     RowBox[{"4.565046282762198`*^-15", " ", "\[ImaginaryI]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7680638889458275`*^9, 3.7680640344367094`*^9}]
}, Open  ]],

Cell["Result is complex...", "Text",
 CellChangeTimes->{{3.768064097070557*^9, 3.7680641010926585`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]\[Mu]CO2", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "\[Equal]", 
      RowBox[{"\[Beta]\[Mu]CO2", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]\[Mu]C5", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "xCO2"}], ",", 
        RowBox[{"\[Rho]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "xCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}], "\[Equal]", 
      RowBox[{"\[Beta]\[Mu]C5", "[", 
       RowBox[{
        RowBox[{"\[Rho]", " ", "yCO2"}], ",", 
        RowBox[{"\[Rho]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "yCO2"}], ")"}]}], ",", "\[Sigma]CO2", ",", 
        "\[Sigma]C5", ",", "\[Epsilon]CO2", ",", "\[Epsilon]C5", ",", 
        "kCO2C5a", ",", "kCO2C5b", ",", "NCO2", ",", "NC5", ",", "\[Beta]"}], 
       "]"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "yCO2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.768064088334756*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7680640849090214`*^9, 3.7680648790620317`*^9}]
}, Open  ]]
}, Open  ]],

Cell["4. Plotting", "Section",
 CellChangeTimes->{{3.7680626952968006`*^9, 3.7680626965187664`*^9}}],

Cell[CellGroupData[{

Cell["2. Numerical Solving", "Section",
 CellChangeTimes->{{3.766171239583239*^9, 3.7661712519377613`*^9}}],

Cell[CellGroupData[{

Cell["Critical Point", "Subsection",
 CellChangeTimes->{{3.766839754582593*^9, 3.7668397558509445`*^9}}],

Cell["\<\
Occurs where both first and second derivatives of pressure with respect to \
density are 0.\
\>", "Text",
 CellChangeTimes->{{3.766839760020883*^9, 3.7668397618747854`*^9}, {
  3.7668398409774218`*^9, 3.7668398505418897`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Beta]p", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref", 
          ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"kB", " ", "Tc"}], ")"}]}], ",", "\[Epsilon]CO2"}], "]"}],
         ",", "\[Rho]"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Beta]p", "[", 
           RowBox[{
            RowBox[{"\[Rho]", "*", "\[Rho]CO2Conv"}], ",", "\[Sigma]CO2Ref", 
            ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"kB", " ", "Tc"}], ")"}]}], ",", "\[Epsilon]CO2"}], 
           "]"}], ",", "\[Rho]"}], "]"}], ",", "\[Rho]"}], "]"}], "\[Equal]", 
      "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "Tc"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7668398524088993`*^9, 3.7668399446859894`*^9}, {
   3.7668399771740246`*^9, 3.7668399933873177`*^9}, 3.766843328080162*^9, {
   3.7674071632982726`*^9, 3.7674071847422366`*^9}, {3.7674557945932255`*^9, 
   3.767455797824287*^9}, {3.7674558594101367`*^9, 3.7674558974899426`*^9}}],

Cell[BoxData[
 RowBox[{"NSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0005944710093545456`", " ", 
        RowBox[{
         SuperscriptBox["\[Beta]p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          RowBox[{"0.0005944710093545456`", " ", "\[Rho]"}], ",", "1", ",", 
          FractionBox["7.24296526998153`*^22", "Tc"], ",", 
          "2.3540082500000002`*^-21"}], "]"}]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"0.0005944710093545456`", " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.0005944710093545456`", " ", 
          RowBox[{
           SuperscriptBox["\[Beta]p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{
            RowBox[{"0.0005944710093545456`", " ", "\[Rho]"}], ",", "1", ",", 
            FractionBox["7.24296526998153`*^22", "Tc"], ",", 
            "2.3540082500000002`*^-21"}], "]"}]}]}], ")"}]}], "\[Equal]", 
      "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "Tc"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7674081289726954`*^9, {3.7674558522628255`*^9, 3.7674558764342637`*^9}, 
   3.7674560678037496`*^9, {3.7677517706940193`*^9, 3.767751807297488*^9}, 
   3.767751895971389*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["\<\
3. Sanity Checks (thermodynamic relations)\
\>", "Section",
 CellChangeTimes->{{3.7661712564080143`*^9, 3.766171272863637*^9}}]
}, Open  ]]
},
WindowSize->{1680, 987},
WindowMargins->{{1912, Automatic}, {Automatic, -66}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 102, 1, 83, "Title"],
Cell[684, 25, 158, 3, 49, "Subtitle"],
Cell[845, 30, 190, 4, 28, "Subsubtitle"],
Cell[1038, 36, 98, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[1161, 41, 95, 1, 41, "Section"],
Cell[1259, 44, 684, 14, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1980, 63, 97, 1, 71, "Section"],
Cell[2080, 66, 774, 21, 31, "Input"],
Cell[2857, 89, 294, 6, 29, "Text"],
Cell[3154, 97, 657, 19, 52, "Input"],
Cell[CellGroupData[{
Cell[3836, 120, 361, 5, 36, "Subsection"],
Cell[4200, 127, 1145, 22, 31, "Input"],
Cell[5348, 151, 628, 10, 47, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6013, 166, 123, 1, 36, "Subsection"],
Cell[6139, 169, 2911, 79, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9087, 253, 142, 2, 36, "Subsection"],
Cell[9232, 257, 3486, 104, 72, "Input"],
Cell[12721, 363, 1181, 30, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13939, 398, 115, 1, 36, "Subsection"],
Cell[14057, 401, 304, 5, 29, "Text"],
Cell[14364, 408, 471, 10, 31, "Input"],
Cell[14838, 420, 1420, 48, 132, "Input"],
Cell[16261, 470, 3059, 86, 52, "Input"],
Cell[19323, 558, 3178, 87, 52, "Input"],
Cell[22504, 647, 733, 20, 52, "Input"],
Cell[23240, 669, 5722, 138, 132, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28999, 812, 109, 1, 36, "Subsection"],
Cell[29111, 815, 1316, 35, 72, "Input"],
Cell[30430, 852, 2605, 52, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33072, 909, 184, 2, 36, "Subsection"],
Cell[33259, 913, 1733, 38, 52, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35029, 956, 151, 2, 36, "Subsection"],
Cell[35183, 960, 1560, 33, 52, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36792, 999, 149, 2, 71, "Section"],
Cell[36944, 1003, 303, 6, 29, "Text"],
Cell[37250, 1011, 8112, 179, 412, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45399, 1195, 197, 2, 71, "Section"],
Cell[45599, 1199, 161, 3, 29, "Text"],
Cell[45763, 1204, 1824, 39, 132, "Input"],
Cell[47590, 1245, 4585, 96, 92, "Input"],
Cell[CellGroupData[{
Cell[52200, 1345, 151, 2, 31, "Input"],
Cell[52354, 1349, 1312, 24, 33, "Output"]
}, Open  ]],
Cell[53681, 1376, 182, 4, 29, "Text"],
Cell[53866, 1382, 969, 20, 132, "Input"],
Cell[CellGroupData[{
Cell[54860, 1406, 6140, 127, 252, "Input"],
Cell[CellGroupData[{
Cell[61025, 1537, 95, 1, 23, "Print"],
Cell[61123, 1540, 93, 1, 23, "Print"],
Cell[61219, 1543, 95, 1, 23, "Print"],
Cell[61317, 1546, 93, 1, 23, "Print"],
Cell[61413, 1549, 95, 1, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61569, 1557, 91, 1, 71, "Section"],
Cell[61663, 1560, 149, 3, 29, "Text"],
Cell[61815, 1565, 1106, 33, 52, "Input"],
Cell[CellGroupData[{
Cell[62946, 1602, 601, 10, 31, "Input"],
Cell[63550, 1614, 977, 22, 248, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64576, 1642, 96, 1, 71, "Section"],
Cell[64675, 1645, 125, 3, 29, "Text"],
Cell[64803, 1650, 1409, 36, 172, "Input"],
Cell[CellGroupData[{
Cell[66237, 1690, 8086, 172, 432, "Input"],
Cell[CellGroupData[{
Cell[74348, 1866, 241, 4, 25, "Print"],
Cell[74592, 1872, 238, 4, 25, "Print"],
Cell[74833, 1878, 273, 7, 23, "Print"],
Cell[75109, 1887, 138, 2, 23, "Print"],
Cell[75250, 1891, 138, 2, 23, "Print"],
Cell[75391, 1895, 273, 7, 23, "Print"]
}, Open  ]],
Cell[75679, 1905, 153, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75869, 1912, 100, 1, 31, "Input"],
Cell[75972, 1915, 143, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76152, 1923, 98, 1, 31, "Input"],
Cell[76253, 1926, 88, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76378, 1932, 102, 1, 31, "Input"],
Cell[76483, 1935, 89, 2, 30, "Output"]
}, Open  ]],
Cell[76587, 1940, 1532, 38, 72, "Input"],
Cell[CellGroupData[{
Cell[78144, 1982, 478, 7, 172, "Input"],
Cell[78625, 1991, 1678, 47, 50, "Output"],
Cell[80306, 2040, 723, 13, 37, "Output"]
}, Open  ]],
Cell[81044, 2056, 477, 8, 29, "Text"],
Cell[CellGroupData[{
Cell[81546, 2068, 4269, 87, 112, "Input"],
Cell[85818, 2157, 252, 4, 30, "Output"]
}, Open  ]],
Cell[86085, 2164, 387, 11, 101, "Text"],
Cell[CellGroupData[{
Cell[86497, 2179, 4161, 88, 92, "Input"],
Cell[90661, 2269, 128, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90826, 2276, 98, 1, 31, "Input"],
Cell[90927, 2279, 7290, 189, 140, "Output"]
}, Open  ]],
Cell[98232, 2471, 201, 4, 29, "Text"],
Cell[CellGroupData[{
Cell[98458, 2479, 3010, 73, 92, "Input"],
Cell[101471, 2554, 77, 1, 30, "Output"]
}, Open  ]],
Cell[101563, 2558, 139, 3, 29, "Text"],
Cell[101705, 2563, 150, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[101880, 2570, 2054, 50, 72, "Input"],
Cell[103937, 2622, 77, 1, 30, "Output"]
}, Open  ]],
Cell[104029, 2626, 305, 6, 29, "Text"],
Cell[104337, 2634, 217, 5, 52, "Input"],
Cell[CellGroupData[{
Cell[104579, 2643, 2222, 54, 52, "Input"],
Cell[106804, 2699, 690, 13, 21, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107531, 2717, 100, 1, 31, "Input"],
Cell[107634, 2720, 455, 10, 37, "Output"]
}, Open  ]],
Cell[108104, 2733, 104, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[108233, 2738, 1871, 46, 52, "Input"],
Cell[110107, 2786, 103, 1, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[110237, 2791, 100, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[110362, 2796, 107, 1, 41, "Section"],
Cell[CellGroupData[{
Cell[110494, 2801, 104, 1, 36, "Subsection"],
Cell[110601, 2804, 236, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[110862, 2813, 1341, 35, 31, "Input"],
Cell[112206, 2850, 1607, 41, 54, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[113852, 2896, 137, 3, 71, "Section"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
